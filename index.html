<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homepage Design Generator Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            min-height: 100vh;
        }

        .header {
            background: white;
            border-bottom: 1px solid #e1e5e9;
            padding: 16px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 2rem;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
                padding: 16px 20px;
            }
            
            .nav-tabs {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .nav-tab {
                flex: 1;
                min-width: 80px;
                justify-content: center;
            }
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
        }

        .nav-tabs {
            display: flex;
            gap: 2px;
            background: #f1f3f4;
            border-radius: 10px;
            padding: 4px;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .nav-tab {
            padding: 10px 16px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #6b7280;
            transition: all 0.2s;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 6px;
            position: relative;
        }

        .nav-tab span {
            font-size: 16px;
            line-height: 1;
        }

        .nav-tab.active {
            background: white;
            color: #1f2937;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .nav-tab:hover:not(.active) {
            background: rgba(255,255,255,0.6);
            color: #374151;
        }


        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 380px 1fr;
            gap: 20px;
            min-height: calc(100vh - 80px);
        }

        .controls {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            height: fit-content;
            position: sticky;
            top: 100px;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
        }

        .preview-section {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .preview-controls {
            background: white;
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .device-selector {
            display: flex;
            gap: 8px;
        }

        .device-btn {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .device-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .preview {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            overflow: hidden;
            position: relative;
            transition: all 0.3s ease;
        }

        .preview.mobile {
            max-width: 375px;
            margin: 0 auto;
        }

        .preview.tablet {
            max-width: 768px;
            margin: 0 auto;
        }

        .preview-header {
            background: #f1f3f4;
            padding: 12px 20px;
            border-bottom: 1px solid #e1e5e9;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .preview-dots {
            display: flex;
            gap: 6px;
        }

        .preview-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #d1d5db;
        }

        .preview-dot:nth-child(1) { background: #ef4444; }
        .preview-dot:nth-child(2) { background: #f59e0b; }
        .preview-dot:nth-child(3) { background: #10b981; }

        .preview-frame {
            background: white;
            min-height: 600px;
            overflow-y: auto;
        }

        h1 {
            font-size: 28px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 8px;
        }

        h2 {
            font-size: 18px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 16px;
            margin-top: 24px;
        }

        h2:first-of-type {
            margin-top: 0;
        }

        .form-group {
            margin-bottom: 16px;
        }

        label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 6px;
        }

        input, select, textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
        }
        
        /* Validation error styles */
        input.validation-error, select.validation-error, textarea.validation-error {
            border-color: #ef4444;
            box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.1);
        }
        
        .validation-error-message {
            color: #ef4444;
            font-size: 0.75rem;
            margin-top: 0.25rem;
            display: block;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .style-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin-bottom: 16px;
        }

        .style-option {
            padding: 16px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .style-option:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }

        .style-option.active {
            border-color: #3b82f6;
            background: #eff6ff;
        }

        .style-name {
            font-size: 13px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .style-desc {
            font-size: 11px;
            color: #6b7280;
            line-height: 1.3;
        }

        /* Professional Style-Specific Styling */
        .style-option[data-style="minimalist"] {
            background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
            border-color: #e2e8f0;
        }

        .style-option[data-style="dashboard"] {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border-color: #475569;
        }
        .style-option[data-style="dashboard"] .style-name {
            color: #f1f5f9;
        }
        .style-option[data-style="dashboard"] .style-desc {
            color: #cbd5e1;
        }

        .style-option[data-style="corporate"] {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            border-color: #2563eb;
        }
        .style-option[data-style="corporate"] .style-name {
            color: #ffffff;
        }
        .style-option[data-style="corporate"] .style-desc {
            color: #dbeafe;
        }

        .style-option[data-style="creative"] {
            background: linear-gradient(135deg, #7c3aed 0%, #ec4899 100%);
            border-color: #a855f7;
        }
        .style-option[data-style="creative"] .style-name {
            color: #ffffff;
        }
        .style-option[data-style="creative"] .style-desc {
            color: #f3e8ff;
        }

        .style-option[data-style="tech"] {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            border-color: #7c3aed;
        }
        .style-option[data-style="tech"] .style-name {
            color: #ffffff;
        }
        .style-option[data-style="tech"] .style-desc {
            color: #e0e7ff;
        }

        .style-option[data-style="ecommerce"] {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            border-color: #047857;
        }
        .style-option[data-style="ecommerce"] .style-name {
            color: #ffffff;
        }
        .style-option[data-style="ecommerce"] .style-desc {
            color: #d1fae5;
        }

        .style-option[data-style="blog"] {
            background: linear-gradient(135deg, #374151 0%, #1f2937 100%);
            border-color: #4b5563;
        }
        .style-option[data-style="blog"] .style-name {
            color: #ffffff;
        }
        .style-option[data-style="blog"] .style-desc {
            color: #d1d5db;
        }

        .style-option[data-style="restaurant"] {
            background: linear-gradient(135deg, #dc2626 0%, #ea580c 100%);
            border-color: #c2410c;
        }
        .style-option[data-style="restaurant"] .style-name {
            color: #ffffff;
        }
        .style-option[data-style="restaurant"] .style-desc {
            color: #fed7aa;
        }

        .style-option[data-style="photography"] {
            background: linear-gradient(135deg, #1c1917 0%, #292524 100%);
            border-color: #d97706;
        }
        .style-option[data-style="photography"] .style-name {
            color: #fbbf24;
        }
        .style-option[data-style="photography"] .style-desc {
            color: #fde68a;
        }

        .style-option[data-style="realestate"] {
            background: linear-gradient(135deg, #92400e 0%, #d97706 100%);
            border-color: #b45309;
        }
        .style-option[data-style="realestate"] .style-name {
            color: #ffffff;
        }
        .style-option[data-style="realestate"] .style-desc {
            color: #fef3c7;
        }

        .style-option[data-style="healthcare"] {
            background: linear-gradient(135deg, #0891b2 0%, #06b6d4 100%);
            border-color: #0e7490;
        }
        .style-option[data-style="healthcare"] .style-name {
            color: #ffffff;
        }
        .style-option[data-style="healthcare"] .style-desc {
            color: #cffafe;
        }

        .style-option[data-style="education"] {
            background: linear-gradient(135deg, #065f46 0%, #059669 100%);
            border-color: #047857;
        }
        .style-option[data-style="education"] .style-name {
            color: #ffffff;
        }
        .style-option[data-style="education"] .style-desc {
            color: #d1fae5;
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 6px;
            margin-bottom: 16px;
        }

        .template-option {
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 12px;
            font-weight: 500;
        }

        .template-option:hover {
            border-color: #3b82f6;
        }

        .template-option.active {
            border-color: #3b82f6;
            background: #eff6ff;
        }

        .template-category {
            margin-bottom: 32px;
            padding: 20px;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            background: #fafafa;
        }

        .template-category-title {
            margin: 0 0 8px 0;
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
        }

        .template-category-desc {
            margin: 0 0 16px 0;
            font-size: 14px;
            color: #6b7280;
            line-height: 1.4;
        }

        .template-option {
            padding: 12px 8px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 11px;
            font-weight: 500;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            min-height: 70px;
        }

        .template-option:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }

        .template-preview {
            width: 100%;
            height: 24px;
            background: linear-gradient(45deg, #f3f4f6 0%, #e5e7eb 100%);
            border-radius: 3px;
            position: relative;
            overflow: hidden;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .template-preview::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            height: 4px;
            background: #3b82f6;
            border-radius: 2px;
            opacity: 0.6;
        }
        
        .template-preview::after {
            content: '▦';
            color: #6b7280;
            font-size: 12px;
            opacity: 0.7;
        }

        .template-name {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .template-desc {
            font-size: 9px;
            color: #6b7280;
            line-height: 1.2;
            margin: 0;
        }

        .page-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 16px;
        }

        .page-btn {
            padding: 6px 12px;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .page-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .button-group {
            display: flex;
            gap: 8px;
            margin-top: 24px;
        }

        button {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
            border: 1px solid #d1d5db;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Component Library Styles */
        .component-library {
            max-height: calc(100vh - 200px);
            overflow-y: auto;
        }

        .component-category {
            margin-bottom: 2rem;
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 1rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .component-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
        }

        .component-card {
            border: 2px dashed #e5e7eb;
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            cursor: grab;
            transition: all 0.3s;
            background: white;
        }

        .component-card:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }

        .component-card:active {
            cursor: grabbing;
        }

        .component-preview-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .component-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
            font-size: 0.85rem;
        }

        .component-desc {
            font-size: 0.75rem;
            color: #6b7280;
            line-height: 1.3;
        }

        /* Drag and Drop Styles */
        .drop-zone {
            min-height: 200px;
            border: 2px dashed #d1d5db;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            transition: all 0.3s;
        }

        .drop-zone.drag-over {
            border-color: #3b82f6;
            background: #eff6ff;
            color: #3b82f6;
        }

        .component-editor {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
            display: none;
        }

        .component-editor.active {
            display: block;
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .editor-title {
            font-weight: 600;
            color: #374151;
        }

        .editor-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #6b7280;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .prop-group {
            margin-bottom: 1rem;
        }

        .prop-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.25rem;
        }

        .canvas-area {
            background: white;
            border-radius: 0.5rem;
            min-height: 400px;
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
        }

        .canvas-component {
            border: 2px solid transparent;
            transition: border-color 0.2s;
            position: relative;
        }

        .canvas-component:hover {
            border-color: #3b82f6;
        }

        .canvas-component.selected {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
        }

        .component-toolbar {
            position: absolute;
            top: -2px;
            right: -2px;
            background: #3b82f6;
            border-radius: 0 0 0 0.375rem;
            padding: 0.25rem;
            display: none;
        }

        .canvas-component:hover .component-toolbar,
        .canvas-component.selected .component-toolbar {
            display: flex;
        }

        .toolbar-btn {
            background: none;
            border: none;
            color: white;
            font-size: 0.75rem;
            padding: 0.25rem;
            cursor: pointer;
            border-radius: 0.25rem;
            margin-left: 0.25rem;
        }

        .toolbar-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .controls {
                position: static;
                max-height: none;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 16px;
            }

            .style-grid {
                grid-template-columns: 1fr 1fr;
            }

            .template-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .theme-option span:last-child {
                display: none;
            }
        }

        /* Theme Toggle Styles */
        .theme-toggle-container {
            margin-top: 8px;
        }
        
        .theme-toggle {
            display: flex;
            background: #f1f3f4;
            border-radius: 8px;
            padding: 4px;
            position: relative;
        }
        
        .theme-toggle input[type="radio"] {
            display: none;
        }
        
        .theme-option {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 13px;
            font-weight: 500;
            color: #6b7280;
        }
        
        .theme-option .theme-icon {
            font-size: 14px;
        }
        
        .theme-toggle input[type="radio"]:checked + .theme-option {
            background: white;
            color: #1f2937;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        /* Brand Colour Tools */
        .brand-color-tools {
            margin-top: 8px;
        }
        
        .colour-section-divider {
            margin-top: 16px; 
            padding-top: 16px; 
            border-top: 1px solid #e9ecef;
        }
        
        .colour-section-title {
            margin: 0 0 12px 0; 
            font-size: 14px; 
            font-weight: 600; 
            color: #374151;
        }
        
        .colour-input-group {
            margin-bottom: 12px;
        }
        
        .colour-input-label {
            display: block; 
            margin-bottom: 6px; 
            font-size: 13px; 
            font-weight: 500; 
            color: #6b7280;
        }
        
        .colour-picker {
            width: 100%; 
            height: 44px; 
            border: 2px solid #d1d5db; 
            border-radius: 6px; 
            cursor: pointer;
        }
        
        .extracted-colours-container {
            display: none; 
            margin-top: 12px; 
            padding: 16px; 
            background: #f8f9fa; 
            border-radius: 8px; 
            border: 1px solid #e9ecef;
        }
        
        /* Enhanced Colour Section Styles */
        .colour-section {
            margin-bottom: 16px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .section-header {
            padding: 12px 16px;
            background: #f9fafb;
            cursor: pointer;
            user-select: none;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background-color 0.2s;
            position: relative;
        }
        
        .section-header:hover {
            background: #f3f4f6;
        }
        
        .section-header .colour-section-title {
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .toggle-icon {
            font-size: 12px;
            transition: transform 0.2s;
            color: #6b7280;
        }
        
        .section-header.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }
        
        .tooltip {
            position: absolute;
            bottom: -28px;
            left: 16px;
            background: #1f2937;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 10;
        }
        
        .section-header:hover .tooltip {
            opacity: 1;
        }
        
        .collapsible-section {
            padding: 16px;
            transition: all 0.3s ease;
            max-height: 500px;
            opacity: 1;
        }
        
        .collapsible-section.collapsed {
            max-height: 0;
            padding: 0 16px;
            opacity: 0;
        }
        
        /* Colour Input Enhancements */
        .colour-input-wrapper {
            display: flex;
            gap: 8px;
            align-items: center;
            position: relative;
        }
        
        .colour-picker {
            flex: 0 0 60px;
            height: 44px;
            border: 2px solid #d1d5db;
            border-radius: 6px;
            cursor: pointer;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        
        .colour-picker:hover {
            border-color: #9ca3af;
        }
        
        .colour-picker:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .hex-input {
            flex: 1;
            height: 44px;
            padding: 8px 12px;
            border: 2px solid #d1d5db;
            border-radius: 6px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 14px;
            text-transform: uppercase;
            transition: border-color 0.2s;
        }
        
        .hex-input:focus {
            outline: none;
            border-color: #3b82f6;
        }
        
        .contrast-indicator {
            flex: 0 0 44px;
            height: 44px;
            border-radius: 6px;
            border: 2px solid #d1d5db;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            position: relative;
            cursor: help;
        }
        
        .contrast-indicator.good {
            background: #10b981;
            color: white;
            border-color: #059669;
        }
        
        .contrast-indicator.warning {
            background: #f59e0b;
            color: white;
            border-color: #d97706;
        }
        
        .contrast-indicator.poor {
            background: #ef4444;
            color: white;
            border-color: #dc2626;
        }
        
        /* Colour Tools */
        .colour-tools {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }
        
        .btn-small {
            flex: 1;
            padding: 8px 12px;
            font-size: 12px;
            font-weight: 500;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            background: white;
            color: #374151;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-small:hover {
            background: #f9fafb;
            border-color: #9ca3af;
        }
        
        /* Presets Grid */
        .presets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 8px;
            margin-bottom: 16px;
        }
        
        .preset-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .preset-item:hover {
            border-color: #3b82f6;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .preset-colours {
            display: flex;
            gap: 2px;
            margin-bottom: 6px;
        }
        
        .preset-swatch {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .preset-name {
            font-size: 11px;
            font-weight: 500;
            color: #6b7280;
            text-align: center;
        }
        
        /* History Swatches */
        .history-swatches {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }
        
        .history-swatch {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            border: 2px solid #e5e7eb;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
        }
        
        .history-swatch:hover {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }
        
        .history-swatch .favourite-star {
            position: absolute;
            top: -6px;
            right: -6px;
            width: 16px;
            height: 16px;
            background: #fbbf24;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            color: white;
        }
        
        /* Messages */
        .colour-message {
            margin-top: 12px;
            padding: 12px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .colour-message.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }
        
        .colour-message.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fca5a5;
        }
        
        /* Loading Spinner */
        .loading-spinner {
            width: 24px;
            height: 24px;
            border: 3px solid #f3f4f6;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .section-divider {
            height: 1px;
            background: #e5e7eb;
            margin: 12px 0;
        }
        
        /* Kanban Board Styles */
        .kanban-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin: 24px 0;
            min-height: 600px;
        }
        
        .kanban-column {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 16px;
            display: flex;
            flex-direction: column;
        }
        
        .kanban-column-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .kanban-column-header h3 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
            color: #374151;
        }
        
        .task-count {
            background: #6b7280;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            min-width: 20px;
            text-align: center;
        }
        
        .kanban-tasks {
            flex: 1;
            min-height: 400px;
            margin-bottom: 12px;
        }
        
        .kanban-task {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 8px;
            cursor: move;
            transition: all 0.2s;
            position: relative;
        }
        
        .kanban-task:hover {
            border-color: #3b82f6;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.15);
            transform: translateY(-1px);
        }
        
        .kanban-task.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }
        
        .task-title {
            font-weight: 600;
            font-size: 14px;
            color: #374151;
            margin-bottom: 6px;
            line-height: 1.3;
        }
        
        .task-description {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .task-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 11px;
            color: #9ca3af;
        }
        
        .task-project {
            background: #ddd6fe;
            color: #5b21b6;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .task-priority {
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .task-priority.high {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .task-priority.medium {
            background: #fef3c7;
            color: #d97706;
        }
        
        .task-priority.low {
            background: #d1fae5;
            color: #059669;
        }
        
        .task-actions {
            position: absolute;
            top: 6px;
            right: 6px;
            opacity: 0;
            transition: opacity 0.2s;
            display: flex;
            gap: 4px;
        }
        
        .kanban-task:hover .task-actions {
            opacity: 1;
        }
        
        .task-action-btn {
            width: 20px;
            height: 20px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .edit-btn {
            background: #dbeafe;
            color: #1d4ed8;
        }
        
        .edit-btn:hover {
            background: #bfdbfe;
        }
        
        .delete-btn {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .delete-btn:hover {
            background: #fecaca;
        }
        
        .add-task-btn {
            width: 100%;
            padding: 8px;
            border: 2px dashed #d1d5db;
            border-radius: 6px;
            background: transparent;
            color: #6b7280;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .add-task-btn:hover {
            border-color: #3b82f6;
            color: #3b82f6;
            background: #f0f9ff;
        }
        
        .kanban-column[data-status="backlog"] .task-count {
            background: #6b7280;
        }
        
        .kanban-column[data-status="design"] .task-count {
            background: #3b82f6;
        }
        
        .kanban-column[data-status="review"] .task-count {
            background: #f59e0b;
        }
        
        .kanban-column[data-status="done"] .task-count {
            background: #10b981;
        }
        
        .kanban-column.drag-over {
            background: #f0f9ff;
            border-color: #3b82f6;
        }
        
        /* Stats Cards */
        .stat-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #3b82f6;
            margin-bottom: 8px;
        }
        
        .stat-label {
            color: #6b7280;
            font-size: 14px;
            font-weight: 500;
        }
        
        /* Task Modal */
        .task-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .task-modal-content {
            background: white;
            border-radius: 8px;
            padding: 24px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .task-modal h3 {
            margin: 0 0 16px 0;
            color: #374151;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .form-field {
            margin-bottom: 16px;
        }
        
        .form-field label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #374151;
            font-size: 14px;
        }
        
        .form-field input,
        .form-field select,
        .form-field textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .form-field textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
        }
        
        @media (max-width: 768px) {
            .kanban-board {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .kanban-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .kanban-controls button,
            .kanban-controls select {
                width: 100%;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        .extracted-palette {
            display: flex;
            gap: 8px;
            margin: 8px 0;
            flex-wrap: wrap;
        }
        
        .color-swatch {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            border: 2px solid #e5e7eb;
            cursor: pointer;
            position: relative;
            transition: transform 0.2s ease;
        }
        
        .color-swatch:hover {
            transform: scale(1.1);
        }
        
        .color-swatch.selected {
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }
        
        .color-swatch .color-info {
            position: absolute;
            bottom: -24px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: #6b7280;
            white-space: nowrap;
        }

        /* Template Marketplace Styles */
        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }

        .template-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .template-card:hover {
            border-color: #3b82f6;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
            transform: translateY(-2px);
        }

        .template-preview {
            width: 100%;
            height: 120px;
            background: #f3f4f6;
            border-radius: 6px;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            font-size: 12px;
        }

        .template-title {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.25rem;
            font-size: 14px;
        }

        .template-meta {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }

        .template-tags {
            display: flex;
            gap: 0.25rem;
            flex-wrap: wrap;
        }

        .template-tag {
            background: #eff6ff;
            color: #1e40af;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 500;
        }


        /* Template Modal Styles */
        .template-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        /* Walkthrough Modal Styles */
        .walkthrough-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .walkthrough-content {
            background: white;
            border-radius: 12px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .walkthrough-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .walkthrough-header h2 {
            margin: 0;
            color: #1f2937;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #6b7280;
            cursor: pointer;
            padding: 0;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .modal-close:hover {
            background: #f3f4f6;
            color: #374151;
        }

        .walkthrough-body {
            padding: 1.5rem;
        }

        .walkthrough-step {
            margin-bottom: 2rem;
        }

        .walkthrough-step:last-child {
            margin-bottom: 0;
        }

        .walkthrough-step h3 {
            color: #1f2937;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .walkthrough-step p {
            color: #4b5563;
            line-height: 1.6;
            margin-bottom: 0.5rem;
        }

        .walkthrough-step ul {
            color: #4b5563;
            line-height: 1.6;
            margin-left: 1rem;
        }

        .walkthrough-step li {
            margin-bottom: 0.25rem;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-header h3 {
            margin: 0;
            color: #1f2937;
            font-size: 1.25rem;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #6b7280;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
        }

        .modal-close:hover {
            background: #f3f4f6;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body>

    <header class="header">
        <div class="header-content">
            <div class="logo">Design Generator Pro</div>
            <nav class="nav-tabs">
                <button class="nav-tab walkthrough" onclick="openWalkthroughModal()">
                    Walkthrough
                </button>
                <button class="nav-tab active" data-tab="design">
                    Design
                </button>
                <button class="nav-tab" data-tab="url-import">
                    URL Import
                </button>
                <button class="nav-tab" data-tab="pa-media">
                    PA Media
                </button>
                <button class="nav-tab" data-tab="kanban">
                    Project Kanban
                </button>
            </nav>
        </div>
    </header>

    <div class="container">
        <div class="controls">
            <!-- Design Tab -->
            <div class="tab-content active" data-tab="design">
                <h1>Design Studio</h1>
                <p style="color: #6b7280; margin-bottom: 24px; font-size: 14px;">Create professional designs with advanced customisation</p>


                <!-- Hidden design style - always use minimalist clean style -->
                <input type="hidden" id="designStyle" value="minimalist">
                
                <h2>Design Templates</h2>
                <p style="color: #6b7280; margin-bottom: 24px; font-size: 14px;">Choose from professionally designed layouts and components</p>

                <!-- Page Layouts -->
                <div class="template-category">
                    <h3 class="template-category-title">Page Layouts</h3>
                    <p class="template-category-desc">Complete page structures for different purposes</p>
                    <div class="template-grid">
                        <div class="template-option active" data-template="hero" title="Bold hero section with large headings and call-to-action">
                            <div class="template-preview"></div>
                            <span class="template-name">Hero</span>
                            <span class="template-desc">Large banner with CTA</span>
                        </div>
                        <div class="template-option" data-template="centered" title="Clean centered layout perfect for focus content">
                            <div class="template-preview"></div>
                            <span class="template-name">Centred</span>
                            <span class="template-desc">Clean focused layout</span>
                        </div>
                        <div class="template-option" data-template="sidebar" title="Two-column layout with navigation sidebar">
                            <div class="template-preview"></div>
                            <span class="template-name">Sidebar</span>
                            <span class="template-desc">Two-column with nav</span>
                        </div>
                        <div class="template-option" data-template="grid" title="Multi-column grid layout for content display">
                            <div class="template-preview"></div>
                            <span class="template-name">Grid</span>
                            <span class="template-desc">Multi-column layout</span>
                        </div>
                        <div class="template-option" data-template="split" title="Split-screen design with image and content">
                            <div class="template-preview"></div>
                            <span class="template-name">Split</span>
                            <span class="template-desc">Half image, half content</span>
                        </div>
                        <div class="template-option" data-template="landing" title="Optimized landing page for conversions">
                            <div class="template-preview"></div>
                            <span class="template-name">Landing</span>
                            <span class="template-desc">Conversion focused</span>
                        </div>
                    </div>
                </div>

                <!-- Specialized Layouts -->  
                <div class="template-category">
                    <h3 class="template-category-title">Specialized Layouts</h3>
                    <p class="template-category-desc">Purpose-built designs for specific industries</p>
                    <div class="template-grid">
                        <div class="template-option" data-template="dashboard-pro" title="Professional dashboard interface with data widgets">
                            <div class="template-preview"></div>
                            <span class="template-name">Dashboard</span>
                            <span class="template-desc">Admin interface</span>
                        </div>
                        <div class="template-option" data-template="portfolio" title="Creative portfolio showcase for designers and artists">
                            <div class="template-preview"></div>
                            <span class="template-name">Portfolio</span>
                            <span class="template-desc">Creative showcase</span>
                        </div>
                        <div class="template-option" data-template="blog-modern" title="Modern blog layout with article previews">
                            <div class="template-preview"></div>
                            <span class="template-name">Blog</span>
                            <span class="template-desc">Article layout</span>
                        </div>
                        <div class="template-option" data-template="ecommerce-grid" title="Product grid layout for online stores">
                            <div class="template-preview"></div>
                            <span class="template-name">E-commerce</span>
                            <span class="template-desc">Product showcase</span>
                        </div>
                        <div class="template-option" data-template="magazine" title="Editorial magazine-style layout">
                            <div class="template-preview"></div>
                            <span class="template-name">Magazine</span>
                            <span class="template-desc">Editorial style</span>
                        </div>
                        <div class="template-option" data-template="timeline" title="Chronological timeline layout for events">
                            <div class="template-preview"></div>
                            <span class="template-name">Timeline</span>
                            <span class="template-desc">Event chronology</span>
                        </div>
                    </div>
                </div>

                <!-- Interactive Components -->
                <div class="template-category">
                    <h3 class="template-category-title">Interactive Components</h3>
                    <p class="template-category-desc">Ready-to-use sections for any website</p>
                    <div class="template-grid">
                        <div class="template-option" data-template="pricing" title="Professional pricing table with plan comparison">
                            <div class="template-preview"></div>
                            <span class="template-name">Pricing Table</span>
                            <span class="template-desc">Plan comparison</span>
                        </div>
                        <div class="template-option" data-template="testimonials" title="Customer testimonials with star ratings">
                            <div class="template-preview"></div>
                            <span class="template-name">Testimonials</span>
                            <span class="template-desc">Customer reviews</span>
                        </div>
                        <div class="template-option" data-template="features" title="Feature grid highlighting key benefits">
                            <div class="template-preview"></div>
                            <span class="template-name">Features Grid</span>
                            <span class="template-desc">Key benefits</span>
                        </div>
                        <div class="template-option" data-template="contact" title="Professional contact form with validation">
                            <div class="template-preview"></div>
                            <span class="template-name">Contact Form</span>
                            <span class="template-desc">Get in touch</span>
                        </div>
                        <div class="template-option" data-template="team" title="Team member profiles with photos and roles">
                            <div class="template-preview"></div>
                            <span class="template-name">Team Members</span>
                            <span class="template-desc">Staff profiles</span>
                        </div>
                        <div class="template-option" data-template="gallery" title="Image gallery with responsive grid layout">
                            <div class="template-preview"></div>
                            <span class="template-name">Gallery</span>
                            <span class="template-desc">Image showcase</span>
                        </div>
                    </div>
                </div>

                <!-- Business Components -->
                <div class="template-category">
                    <h3 class="template-category-title">Business Components</h3>
                    <p class="template-category-desc">Professional elements for business websites</p>
                    <div class="template-grid">
                        <div class="template-option" data-template="stats" title="Key statistics and metrics display">
                            <div class="template-preview"></div>
                            <span class="template-name">Statistics</span>
                            <span class="template-desc">Key metrics</span>
                        </div>
                        <div class="template-option" data-template="comparison" title="Side-by-side feature comparison table">
                            <div class="template-preview"></div>
                            <span class="template-name">Comparison</span>
                            <span class="template-desc">Feature comparison</span>
                        </div>
                        <div class="template-option" data-template="cta" title="Call-to-action section to drive conversions">
                            <div class="template-preview"></div>
                            <span class="template-name">Call-to-Action</span>
                            <span class="template-desc">Drive conversions</span>
                        </div>
                        <div class="template-option" data-template="faq" title="Frequently asked questions section">
                            <div class="template-preview"></div>
                            <span class="template-name">FAQ Section</span>
                            <span class="template-desc">Common questions</span>
                        </div>
                    </div>
                </div>

                <h2>Layout Customization</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label for="layoutDensity">Component Density</label>
                        <select id="layoutDensity">
                            <option value="compact">Compact - Tight spacing</option>
                            <option value="comfortable" selected>Comfortable - Balanced spacing</option>
                            <option value="spacious">Spacious - Generous spacing</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="containerWidth">Container Width</label>
                        <select id="containerWidth">
                            <option value="narrow">Narrow (960px)</option>
                            <option value="standard" selected>Standard (1200px)</option>
                            <option value="wide">Wide (1400px)</option>
                            <option value="full">Full Width</option>
                        </select>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label for="borderRadius">Border Radius</label>
                        <select id="borderRadius">
                            <option value="none">Sharp (0px)</option>
                            <option value="small">Small (4px)</option>
                            <option value="medium" selected>Medium (8px)</option>
                            <option value="large">Large (16px)</option>
                            <option value="full">Rounded (24px)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="shadowIntensity">Shadow Depth</label>
                        <select id="shadowIntensity">
                            <option value="none">No Shadow</option>
                            <option value="subtle" selected>Subtle</option>
                            <option value="medium">Medium</option>
                            <option value="strong">Strong</option>
                            <option value="dramatic">Dramatic</option>
                        </select>
                    </div>
                </div>

                <h2>Content</h2>
                <div class="form-group">
                    <label for="siteTitle">Site Title</label>
                    <input type="text" id="siteTitle" value="Your Brand" placeholder="Enter site title">
                </div>

                <div class="form-group">
                    <label for="siteSubtitle">Subtitle</label>
                    <input type="text" id="siteSubtitle" value="Creating beautiful experiences" placeholder="Enter subtitle">
                </div>

                <div class="form-group">
                    <label for="navLinks">Navigation Links (one per line)</label>
                    <textarea id="navLinks" placeholder="Home&#10;About&#10;Services&#10;Contact">Home
About
Services
Contact</textarea>
                </div>

                <div class="form-group">
                    <label for="mainContent">Main Content</label>
                    <textarea id="mainContent" placeholder="Enter your main content">Welcome to our professional homepage. We create modern, responsive designs that focus on user experience and conversion.</textarea>
                </div>

                <h2>Styling</h2>
                <div class="form-group">
                    <label for="colorScheme">Colour Scheme</label>
                    <select id="colorScheme">
                        <option value="blue">Blue</option>
                        <option value="monochrome">Grey</option>
                        <option value="green">Green</option>
                        <option value="purple">Purple</option>
                        <option value="orange">Orange</option>
                        <option value="dark">Dark</option>
                        <option value="colorblind">Colourblind Friendly</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="fontFamily">Typography</label>
                    <select id="fontFamily">
                        <option value="sans">Modern Sans</option>
                        <option value="serif">Classic Serif</option>
                        <option value="mono">Developer Mono</option>
                        <option value="display">Display Font</option>
                    </select>
                </div>


                <div class="form-group">
                    <label for="brandColorExtractor">Brand Colours</label>
                    <div class="brand-color-tools">
                        
                        <!-- Logo Extraction Section -->
                        <div class="colour-section">
                            <div class="section-header" onclick="toggleSection('logoSection')">
                                <h4 class="colour-section-title">Extract from Logo <span class="toggle-icon">▼</span></h4>
                                <div class="tooltip">Upload a logo to automatically extract brand colours</div>
                            </div>
                            <div id="logoSection" class="collapsible-section">
                                <input type="file" id="logoUpload" accept="image/*" style="display: none;">
                                <button class="btn-secondary" onclick="document.getElementById('logoUpload').click()" style="width: 100%; margin-bottom: 12px; height: 44px; font-weight: 500;">
                                    Extract Colours from Logo
                                </button>
                                <div id="logoPreview" style="display: none; margin-bottom: 12px; text-align: center;">
                                    <img id="logoImage" style="max-width: 100%; max-height: 80px; border-radius: 6px; border: 1px solid #d1d5db;">
                                </div>
                                <div id="extractedColors" class="extracted-colours-container">
                                    <div class="extraction-info" id="extractionInfo" style="display: none; margin-bottom: 12px; font-size: 12px; color: #6b7280;"></div>
                                    <div class="extracted-palette" id="colorPalette"></div>
                                    <button class="btn-primary" onclick="applyExtractedColors()" style="width: 100%; margin-top: 12px; height: 40px; font-weight: 500; display: none;" id="applyExtractedBtn">
                                        Apply Selected Colours
                                    </button>
                                </div>
                                <div id="logoLoadingState" style="display: none; text-align: center; padding: 20px; color: #6b7280;">
                                    <div class="loading-spinner"></div>
                                    <div style="margin-top: 8px;">Extracting colours...</div>
                                </div>
                            </div>
                        </div>

                        <!-- Custom Colours Section -->
                        <div class="colour-section">
                            <div class="section-header" onclick="toggleSection('customSection')">
                                <h4 class="colour-section-title">Custom Colours <span class="toggle-icon">▼</span></h4>
                                <div class="tooltip">Manually select your brand colours</div>
                            </div>
                            <div id="customSection" class="collapsible-section">
                                <div class="colour-input-group">
                                    <label for="customPrimary" class="colour-input-label">Primary Colour</label>
                                    <div class="colour-input-wrapper">
                                        <input type="color" id="customPrimary" value="#3b82f6" class="colour-picker" oninput="updateColourPreview('primary', this.value)">
                                        <input type="text" id="primaryHex" value="#3b82f6" class="hex-input" oninput="updateColourFromHex('primary', this.value)" maxlength="7">
                                        <div class="contrast-indicator" id="primaryContrast"></div>
                                    </div>
                                </div>
                                <div class="colour-input-group">
                                    <label for="customSecondary" class="colour-input-label">Secondary Colour</label>
                                    <div class="colour-input-wrapper">
                                        <input type="color" id="customSecondary" value="#8b5cf6" class="colour-picker" oninput="updateColourPreview('secondary', this.value)">
                                        <input type="text" id="secondaryHex" value="#8b5cf6" class="hex-input" oninput="updateColourFromHex('secondary', this.value)" maxlength="7">
                                        <div class="contrast-indicator" id="secondaryContrast"></div>
                                    </div>
                                </div>
                                <div class="colour-tools">
                                    <button class="btn-small" onclick="generateHarmony()">Generate Harmony</button>
                                    <button class="btn-small" onclick="adjustBrightness(10)">Brighter</button>
                                    <button class="btn-small" onclick="adjustBrightness(-10)">Darker</button>
                                </div>
                            </div>
                        </div>

                        <!-- Colour Presets Section -->
                        <div class="colour-section">
                            <div class="section-header" onclick="toggleSection('presetsSection')">
                                <h4 class="colour-section-title">Colour Presets <span class="toggle-icon">▼</span></h4>
                                <div class="tooltip">Quick access to popular colour schemes</div>
                            </div>
                            <div id="presetsSection" class="collapsible-section collapsed">
                                <div class="presets-grid" id="presetsGrid">
                                    <!-- Presets will be populated by JavaScript -->
                                </div>
                                <div class="section-divider"></div>
                                <div class="colour-history" id="colourHistory">
                                    <h5 style="font-size: 12px; color: #6b7280; margin-bottom: 8px;">Recent Colours</h5>
                                    <div class="history-swatches" id="historySwatches"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Success/Error Messages -->
                        <div id="colourMessage" class="colour-message" style="display: none;"></div>
                        
                    </div>
                </div>
            </div>

            <!-- URL Import Tab -->
            <div class="tab-content" data-tab="url-import">
                <h1>URL Import & Analysis</h1>
                <p style="color: #6b7280; margin-bottom: 24px; font-size: 14px;">Import and analyse existing websites for design inspiration</p>

                <h2>Website URL</h2>
                <div class="form-group">
                    <label for="websiteUrl">Enter URL to analyse</label>
                    <input type="url" id="websiteUrl" placeholder="https://example.com" style="margin-bottom: 8px;">
                    <button class="btn-primary" onclick="processURL()" style="width: 100%;" id="processUrlBtn">
                        Analyse Website
                    </button>
                </div>

                <div id="urlAnalysisLoading" style="display: none; text-align: center; padding: 2rem; color: #6b7280;">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">⏳</div>
                    <div>Analyzing website...</div>
                    <div style="font-size: 0.875rem; margin-top: 0.5rem;">This may take a few seconds</div>
                </div>

                <div id="urlAnalysisResults" style="display: none;">
                    <h2>Analysis Results</h2>
                    
                    <div class="form-group">
                        <label>Extracted Website Information</label>
                        <div id="extractedInfo" style="background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">
                            <!-- Extracted site info will appear here -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Color Palette</label>
                        <div id="extractedColorPalette" style="display: flex; gap: 8px; margin-bottom: 1rem; flex-wrap: wrap;">
                            <!-- Extracted colors will appear here -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Suggested Design Style</label>
                        <div id="suggestedStyle" style="background: #eff6ff; border: 1px solid #bfdbfe; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">
                            <!-- Style suggestions will appear here -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Content Extraction</label>
                        <div id="extractedContent" style="background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; max-height: 200px; overflow-y: auto;">
                            <!-- Extracted content will appear here -->
                        </div>
                    </div>

                    <div class="button-group" style="margin-top: 1.5rem;">
                        <button class="btn-secondary" onclick="showComparison()" style="flex: 1;">
                            👀 Preview Comparison
                        </button>
                        <button class="btn-primary" onclick="applyAnalysisResults()" style="flex: 1;">
                            ✨ Apply to Design
                        </button>
                    </div>
                </div>

                <div id="comparisonView" style="display: none; margin-top: 2rem;">
                    <h2>Before vs After Comparison</h2>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                        <div>
                            <h3 style="font-size: 1rem; margin-bottom: 0.5rem; color: #374151;">Original Website</h3>
                            <div id="originalPreview" style="border: 1px solid #d1d5db; border-radius: 8px; padding: 1rem; background: #f9fafb; min-height: 200px; font-size: 0.875rem; color: #6b7280;">
                                Original website preview will appear here
                            </div>
                        </div>
                        <div>
                            <h3 style="font-size: 1rem; margin-bottom: 0.5rem; color: #374151;">New Design</h3>
                            <div id="newDesignPreview" style="border: 1px solid #d1d5db; border-radius: 8px; padding: 1rem; background: #f9fafb; min-height: 200px; font-size: 0.875rem; color: #6b7280;">
                                New design preview will appear here
                            </div>
                        </div>
                    </div>
                </div>

                <div style="background: #fef3c7; border: 1px solid #fbbf24; border-radius: 8px; padding: 1rem; margin-top: 1.5rem;">
                    <h3 style="color: #92400e; margin-bottom: 0.5rem; font-size: 1rem;">💡 How it works</h3>
                    <ul style="color: #92400e; font-size: 0.875rem; margin: 0; padding-left: 1.5rem;">
                        <li>Enter any website URL to analyze its design and content</li>
                        <li>Extract colors, fonts, layout patterns, and content structure</li>
                        <li>Get AI-powered design style recommendations</li>
                        <li>Apply extracted elements to your new design</li>
                        <li>Preview before/after comparison of improvements</li>
                    </ul>
                </div>
            </div>





            <!-- PA Media Tab -->
            <div class="tab-content" data-tab="pa-media">
                <h1>PA Media Brand Templates</h1>
                <p style="color: #6b7280; margin-bottom: 24px; font-size: 14px;">Professional branded templates and design assets for PA Media Group</p>

                <div style="background: linear-gradient(135deg, #825FFF 0%, #3D3677 100%); color: white; padding: 2rem; border-radius: 12px; margin-bottom: 2rem;">
                    <h2 style="color: white; margin-bottom: 1rem; font-size: 1.5rem;">PA Media Design System</h2>
                    <p style="color: #e0d4ff; margin-bottom: 1.5rem;">Complete branded template suite designed specifically for PA Media Group's professional requirements.</p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1.5rem;">
                        <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
                            <h4 style="color: white; margin-bottom: 0.5rem;">Brand Colors</h4>
                            <p style="color: #e0d4ff; font-size: 0.9rem;">#825FFF Primary<br>#3D3677 Secondary</p>
                        </div>
                        <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
                            <h4 style="color: white; margin-bottom: 0.5rem;">Typography</h4>
                            <p style="color: #e0d4ff; font-size: 0.9rem;">Professional Sans-Serif<br>Clean & Modern</p>
                        </div>
                        <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
                            <h4 style="color: white; margin-bottom: 0.5rem;">Templates</h4>
                            <p style="color: #e0d4ff; font-size: 0.9rem;">15+ Professional<br>Ready-to-use Assets</p>
                        </div>
                    </div>
                </div>

                <h2>Template Categories</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                    
                    <div style="border: 1px solid #e5e7eb; border-radius: 12px; padding: 1.5rem; background: white;">
                        <h3 style="color: #825FFF; margin-bottom: 1rem;">Website Templates</h3>
                        <p style="color: #6b7280; margin-bottom: 1rem; font-size: 0.9rem;">Professional website designs with PA Media branding</p>
                        <ul style="color: #4b5563; font-size: 0.9rem; margin-bottom: 1.5rem; padding-left: 1.2rem;">
                            <li>Corporate Homepage</li>
                            <li>News Portal Layout</li>
                            <li>Service Pages</li>
                            <li>Contact Templates</li>
                        </ul>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                            <button onclick="previewPATemplate('website')" style="background: #e5e7eb; color: #374151; border: none; padding: 0.75rem 1rem; border-radius: 6px; font-size: 0.9rem; font-weight: 500; cursor: pointer;">Preview</button>
                            <button onclick="downloadPATemplate('website')" style="background: #825FFF; color: white; border: none; padding: 0.75rem 1rem; border-radius: 6px; font-size: 0.9rem; font-weight: 500; cursor: pointer;">Download</button>
                        </div>
                    </div>

                    <div style="border: 1px solid #e5e7eb; border-radius: 12px; padding: 1.5rem; background: white;">
                        <h3 style="color: #825FFF; margin-bottom: 1rem;">Presentation Assets</h3>
                        <p style="color: #6b7280; margin-bottom: 1rem; font-size: 0.9rem;">Professional PowerPoint and presentation materials</p>
                        <ul style="color: #4b5563; font-size: 0.9rem; margin-bottom: 1.5rem; padding-left: 1.2rem;">
                            <li>Master Slide Templates</li>
                            <li>Corporate Presentations</li>
                            <li>Chart & Graph Templates</li>
                            <li>Brand Guidelines Deck</li>
                        </ul>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                            <button onclick="previewPATemplate('presentation')" style="background: #e5e7eb; color: #374151; border: none; padding: 0.75rem 1rem; border-radius: 6px; font-size: 0.9rem; font-weight: 500; cursor: pointer;">Preview</button>
                            <button onclick="downloadPATemplate('presentation')" style="background: #825FFF; color: white; border: none; padding: 0.75rem 1rem; border-radius: 6px; font-size: 0.9rem; font-weight: 500; cursor: pointer;">Download</button>
                        </div>
                    </div>

                    <div style="border: 1px solid #e5e7eb; border-radius: 12px; padding: 1.5rem; background: white;">
                        <h3 style="color: #825FFF; margin-bottom: 1rem;">Digital Assets</h3>
                        <p style="color: #6b7280; margin-bottom: 1rem; font-size: 0.9rem;">Teams backgrounds and digital brand materials</p>
                        <ul style="color: #4b5563; font-size: 0.9rem; margin-bottom: 1.5rem; padding-left: 1.2rem;">
                            <li>Teams Meeting Backgrounds</li>
                            <li>Social Media Templates</li>
                            <li>Email Signatures</li>
                            <li>Digital Letterheads</li>
                        </ul>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                            <button onclick="previewPATemplate('digital')" style="background: #e5e7eb; color: #374151; border: none; padding: 0.75rem 1rem; border-radius: 6px; font-size: 0.9rem; font-weight: 500; cursor: pointer;">Preview</button>
                            <button onclick="downloadPATemplate('digital')" style="background: #825FFF; color: white; border: none; padding: 0.75rem 1rem; border-radius: 6px; font-size: 0.9rem; font-weight: 500; cursor: pointer;">Download</button>
                        </div>
                    </div>

                    <div style="border: 1px solid #e5e7eb; border-radius: 12px; padding: 1.5rem; background: white;">
                        <h3 style="color: #825FFF; margin-bottom: 1rem;">Print Materials</h3>
                        <p style="color: #6b7280; margin-bottom: 1rem; font-size: 0.9rem;">Professional print-ready templates and stationery</p>
                        <ul style="color: #4b5563; font-size: 0.9rem; margin-bottom: 1.5rem; padding-left: 1.2rem;">
                            <li>Business Card Templates</li>
                            <li>Letterhead Designs</li>
                            <li>Brochure Layouts</li>
                            <li>Report Templates</li>
                        </ul>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                            <button onclick="previewPATemplate('print')" style="background: #e5e7eb; color: #374151; border: none; padding: 0.75rem 1rem; border-radius: 6px; font-size: 0.9rem; font-weight: 500; cursor: pointer;">Preview</button>
                            <button onclick="downloadPATemplate('print')" style="background: #825FFF; color: white; border: none; padding: 0.75rem 1rem; border-radius: 6px; font-size: 0.9rem; font-weight: 500; cursor: pointer;">Download</button>
                        </div>
                    </div>
                </div>

                <h2>Brand Guidelines</h2>
                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px; padding: 2rem; margin-bottom: 2rem;">
                    <h3 style="color: #374151; margin-bottom: 1rem;">PA Media Brand Standards</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
                        <div>
                            <h4 style="color: #825FFF; margin-bottom: 0.5rem;">Color Palette</h4>
                            <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                                <div style="width: 40px; height: 40px; background: #825FFF; border-radius: 6px; border: 2px solid #e5e7eb;"></div>
                                <div style="width: 40px; height: 40px; background: #3D3677; border-radius: 6px; border: 2px solid #e5e7eb;"></div>
                                <div style="width: 40px; height: 40px; background: #ffffff; border-radius: 6px; border: 2px solid #e5e7eb;"></div>
                            </div>
                            <p style="color: #6b7280; font-size: 0.9rem;">Primary: #825FFF<br>Secondary: #3D3677<br>Neutral: #FFFFFF</p>
                        </div>
                        <div>
                            <h4 style="color: #825FFF; margin-bottom: 0.5rem;">Typography Guidelines</h4>
                            <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Professional sans-serif typography with clear hierarchy and excellent readability for all applications.</p>
                        </div>
                        <div>
                            <h4 style="color: #825FFF; margin-bottom: 0.5rem;">Logo Usage</h4>
                            <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Consistent logo application across all materials with proper spacing and color variants.</p>
                        </div>
                    </div>
                    <button onclick="downloadBrandGuidelines()" style="background: #374151; color: white; border: none; padding: 1rem 2rem; border-radius: 6px; font-weight: 500; cursor: pointer; margin-top: 1.5rem;">Download Complete Brand Guidelines</button>
                </div>

                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button onclick="downloadAllPATemplates()" style="background: #825FFF; color: white; border: none; padding: 1rem 2rem; border-radius: 6px; font-weight: 500; cursor: pointer; flex: 1;">Download Complete Template Suite</button>
                    <button onclick="previewPATemplates()" style="background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; padding: 1rem 2rem; border-radius: 6px; font-weight: 500; cursor: pointer; flex: 1;">Preview All Templates</button>
                </div>
            </div>

            <!-- Kanban Tab -->
            <div class="tab-content" data-tab="kanban">
                <h1>Project Kanban Board</h1>
                <p style="color: #6b7280; margin-bottom: 24px; font-size: 14px;">Organize and track your design projects with visual task management</p>

                <!-- Kanban Controls -->
                <div class="kanban-controls" style="margin-bottom: 24px; display: flex; gap: 12px; align-items: center; flex-wrap: wrap;">
                    <button class="btn-primary" onclick="createNewProject()" style="font-size: 14px; padding: 8px 16px;">
                        + New Project
                    </button>
                    <button class="btn-secondary" onclick="createNewTask()" style="font-size: 14px; padding: 8px 16px;">
                        + Add Task
                    </button>
                    <select id="projectFilter" onchange="filterByProject()" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 14px;">
                        <option value="">All Projects</option>
                    </select>
                    <button class="btn-secondary" onclick="exportKanbanData()" style="font-size: 14px; padding: 8px 16px;">
                        Export Data
                    </button>
                </div>

                <!-- Kanban Board -->
                <div class="kanban-board" id="kanbanBoard">
                    <div class="kanban-column" data-status="backlog">
                        <div class="kanban-column-header">
                            <h3>📝 Backlog</h3>
                            <span class="task-count" id="backlog-count">0</span>
                        </div>
                        <div class="kanban-tasks" id="backlog-tasks" ondrop="dropTask(event)" ondragover="allowDrop(event)">
                            <!-- Tasks will be added here -->
                        </div>
                        <button class="add-task-btn" onclick="addTaskToColumn('backlog')">+ Add Task</button>
                    </div>

                    <div class="kanban-column" data-status="design">
                        <div class="kanban-column-header">
                            <h3>🎨 In Design</h3>
                            <span class="task-count" id="design-count">0</span>
                        </div>
                        <div class="kanban-tasks" id="design-tasks" ondrop="dropTask(event)" ondragover="allowDrop(event)">
                            <!-- Tasks will be added here -->
                        </div>
                        <button class="add-task-btn" onclick="addTaskToColumn('design')">+ Add Task</button>
                    </div>

                    <div class="kanban-column" data-status="review">
                        <div class="kanban-column-header">
                            <h3>👀 Review</h3>
                            <span class="task-count" id="review-count">0</span>
                        </div>
                        <div class="kanban-tasks" id="review-tasks" ondrop="dropTask(event)" ondragover="allowDrop(event)">
                            <!-- Tasks will be added here -->
                        </div>
                        <button class="add-task-btn" onclick="addTaskToColumn('review')">+ Add Task</button>
                    </div>

                    <div class="kanban-column" data-status="done">
                        <div class="kanban-column-header">
                            <h3>✅ Done</h3>
                            <span class="task-count" id="done-count">0</span>
                        </div>
                        <div class="kanban-tasks" id="done-tasks" ondrop="dropTask(event)" ondragover="allowDrop(event)">
                            <!-- Tasks will be added here -->
                        </div>
                        <button class="add-task-btn" onclick="addTaskToColumn('done')">+ Add Task</button>
                    </div>
                </div>

                <!-- Project Stats -->
                <div class="project-stats" style="margin-top: 32px; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                    <div class="stat-card">
                        <div class="stat-number" id="totalTasks">0</div>
                        <div class="stat-label">Total Tasks</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="completedTasks">0</div>
                        <div class="stat-label">Completed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="activeTasks">0</div>
                        <div class="stat-label">In Progress</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="completionRate">0%</div>
                        <div class="stat-label">Completion Rate</div>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button type="button" class="btn-secondary" onclick="resetForm()">Reset</button>
                <button type="button" class="btn-secondary" onclick="generateClaudeCodePrompt()" style="background: #10b981; color: white;">Copy Claude Prompt</button>
                <button type="button" class="btn-primary" onclick="downloadHTML()">Quick Export</button>
            </div>

            <h2>Claude Code Prompt Preview</h2>
            <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
                <div id="claudePromptPreview" style="font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 0.9rem; line-height: 1.5; color: #374151; white-space: pre-wrap; max-height: 300px; overflow-y: auto;">
                    <!-- Claude prompt preview will appear here -->
                </div>
            </div>
        </div>

        <div class="preview-section">
            <div class="preview-controls">
                <div class="device-selector">
                    <button class="device-btn active" data-device="desktop">Desktop</button>
                    <button class="device-btn" data-device="tablet">Tablet</button>
                    <button class="device-btn" data-device="mobile">Mobile</button>
                </div>
                <span style="font-size: 12px; color: #6b7280;">Live Preview</span>
            </div>

            <div class="preview desktop" id="preview">
                <div class="preview-header">
                    <div class="preview-dots">
                        <div class="preview-dot"></div>
                        <div class="preview-dot"></div>
                        <div class="preview-dot"></div>
                    </div>
                    <span style="font-size: 12px; color: #6b7280; margin-left: 8px;">Preview</span>
                </div>
                <div class="preview-frame" id="previewFrame">
                    <!-- Generated preview will appear here -->
                </div>
                <div class="canvas-area" id="canvasArea" style="display: none;">
                    <div class="drop-zone" id="dropZone">
                        <span>Drag components here to build your page</span>
                    </div>
                    <div id="canvasComponents">
                        <!-- Dropped components will appear here -->
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script src="assets/templates.js"></script>
    <script src="assets/components.js"></script>
    <script src="assets/design-tokens.js"></script>
    <script src="assets/exporters.js"></script>
    <script src="assets/ai-content.js"></script>
    <script src="assets/accessibility.js"></script>
    <script src="assets/animations.js"></script>
    <script src="assets/content-extractor.js"></script>
    <script src="assets/style-analyzer.js"></script>
    <script src="assets/url-processor.js"></script>
    <script src="assets/claude-integration.js"></script>
    <script src="assets/pa-media-templates.js"></script>
    <script src="assets/app.js"></script>
    
    <script>
        // Global helper functions
        function switchToTab(tabName) {
            if (window.designGenerator) {
                window.designGenerator.switchTab(tabName);
            }
        }

        // Enhanced Colour System Variables
        let colourHistory = JSON.parse(localStorage.getItem('colourHistory') || '[]');
        let favouriteColours = JSON.parse(localStorage.getItem('favouriteColours') || '[]');
        
        // Colour Presets
        const colourPresets = [
            { name: 'Material Blue', primary: '#2196F3', secondary: '#03A9F4' },
            { name: 'Material Purple', primary: '#9C27B0', secondary: '#673AB7' },
            { name: 'Material Teal', primary: '#009688', secondary: '#00BCD4' },
            { name: 'Material Orange', primary: '#FF9800', secondary: '#FF5722' },
            { name: 'Tailwind Blue', primary: '#3B82F6', secondary: '#1D4ED8' },
            { name: 'Tailwind Emerald', primary: '#10B981', secondary: '#059669' },
            { name: 'Tailwind Rose', primary: '#F43F5E', secondary: '#E11D48' },
            { name: 'Tailwind Violet', primary: '#8B5CF6', secondary: '#7C3AED' },
            { name: 'Corporate Blue', primary: '#1E3A8A', secondary: '#3B82F6' },
            { name: 'Forest Green', primary: '#047857', secondary: '#10B981' },
            { name: 'Sunset Orange', primary: '#EA580C', secondary: '#F97316' },
            { name: 'Royal Purple', primary: '#6B21A8', secondary: '#A855F7' }
        ];

        // Enhanced Colour Functions
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            const header = section.previousElementSibling;
            
            if (section.classList.contains('collapsed')) {
                section.classList.remove('collapsed');
                header.classList.remove('collapsed');
            } else {
                section.classList.add('collapsed');
                header.classList.add('collapsed');
            }
        }

        function updateColourPreview(type, colour) {
            // Real-time preview update
            if (window.designGenerator && window.designGenerator.updatePreview) {
                const data = window.designGenerator.getCurrentData();
                if (type === 'primary') {
                    data.primaryColor = colour;
                    document.getElementById('primaryHex').value = colour;
                } else if (type === 'secondary') {
                    data.secondaryColor = colour;
                    document.getElementById('secondaryHex').value = colour;
                }
                window.designGenerator.updatePreview();
            }
            
            // Update contrast indicators
            updateContrastIndicator(type, colour);
            
            // Add to history
            addToColourHistory(colour);
        }

        function updateColourFromHex(type, hexValue) {
            if (hexValue.match(/^#[0-9A-F]{6}$/i)) {
                const colorInput = document.getElementById(type === 'primary' ? 'customPrimary' : 'customSecondary');
                colorInput.value = hexValue;
                updateColourPreview(type, hexValue);
            }
        }

        function updateContrastIndicator(type, colour) {
            const indicator = document.getElementById(type + 'Contrast');
            const contrastRatio = getContrastRatio(colour, '#FFFFFF');
            
            indicator.classList.remove('good', 'warning', 'poor');
            
            if (contrastRatio >= 7) {
                indicator.classList.add('good');
                indicator.textContent = 'AAA';
                indicator.title = `Contrast ratio: ${contrastRatio.toFixed(1)}:1 (Excellent)`;
            } else if (contrastRatio >= 4.5) {
                indicator.classList.add('warning');
                indicator.textContent = 'AA';
                indicator.title = `Contrast ratio: ${contrastRatio.toFixed(1)}:1 (Good)`;
            } else {
                indicator.classList.add('poor');
                indicator.textContent = 'FAIL';
                indicator.title = `Contrast ratio: ${contrastRatio.toFixed(1)}:1 (Poor accessibility)`;
            }
        }

        function getContrastRatio(color1, color2) {
            const l1 = getLuminance(color1);
            const l2 = getLuminance(color2);
            const lighter = Math.max(l1, l2);
            const darker = Math.min(l1, l2);
            return (lighter + 0.05) / (darker + 0.05);
        }

        function getLuminance(hex) {
            const rgb = hexToRgb(hex);
            const [r, g, b] = [rgb.r, rgb.g, rgb.b].map(c => {
                c = c / 255;
                return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
            });
            return 0.2126 * r + 0.7152 * g + 0.0722 * b;
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        }

        function generateHarmony() {
            const primaryColour = document.getElementById('customPrimary').value;
            const hsl = hexToHsl(primaryColour);
            
            // Generate complementary colour
            const complementaryHue = (hsl.h + 180) % 360;
            const complementaryColour = hslToHex(complementaryHue, hsl.s, hsl.l);
            
            document.getElementById('customSecondary').value = complementaryColour;
            document.getElementById('secondaryHex').value = complementaryColour;
            updateColourPreview('secondary', complementaryColour);
            
            showColourMessage('Generated complementary colour scheme!', 'success');
        }

        function adjustBrightness(adjustment) {
            const primaryColour = document.getElementById('customPrimary').value;
            const secondaryColour = document.getElementById('customSecondary').value;
            
            const newPrimary = adjustColourBrightness(primaryColour, adjustment);
            const newSecondary = adjustColourBrightness(secondaryColour, adjustment);
            
            document.getElementById('customPrimary').value = newPrimary;
            document.getElementById('primaryHex').value = newPrimary;
            document.getElementById('customSecondary').value = newSecondary;
            document.getElementById('secondaryHex').value = newSecondary;
            
            updateColourPreview('primary', newPrimary);
            updateColourPreview('secondary', newSecondary);
            
            showColourMessage(`Adjusted brightness by ${adjustment > 0 ? '+' : ''}${adjustment}%`, 'success');
        }

        function adjustColourBrightness(hex, percent) {
            const rgb = hexToRgb(hex);
            const factor = percent / 100;
            
            const newR = Math.min(255, Math.max(0, rgb.r + (rgb.r * factor)));
            const newG = Math.min(255, Math.max(0, rgb.g + (rgb.g * factor)));
            const newB = Math.min(255, Math.max(0, rgb.b + (rgb.b * factor)));
            
            return rgbToHex(Math.round(newR), Math.round(newG), Math.round(newB));
        }

        function hexToHsl(hex) {
            const rgb = hexToRgb(hex);
            const r = rgb.r / 255;
            const g = rgb.g / 255;
            const b = rgb.b / 255;
            
            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;
            
            if (max === min) {
                h = s = 0;
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
            }
            
            return { h: h * 360, s: s * 100, l: l * 100 };
        }

        function hslToHex(h, s, l) {
            h = h / 360;
            s = s / 100;
            l = l / 100;
            
            const hue2rgb = (p, q, t) => {
                if (t < 0) t += 1;
                if (t > 1) t -= 1;
                if (t < 1/6) return p + (q - p) * 6 * t;
                if (t < 1/2) return q;
                if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                return p;
            };
            
            let r, g, b;
            if (s === 0) {
                r = g = b = l;
            } else {
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            
            return rgbToHex(Math.round(r * 255), Math.round(g * 255), Math.round(b * 255));
        }

        function rgbToHex(r, g, b) {
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        }

        function addToColourHistory(colour) {
            if (!colourHistory.includes(colour)) {
                colourHistory.unshift(colour);
                if (colourHistory.length > 12) {
                    colourHistory.pop();
                }
                localStorage.setItem('colourHistory', JSON.stringify(colourHistory));
                updateHistoryDisplay();
            }
        }

        function updateHistoryDisplay() {
            const container = document.getElementById('historySwatches');
            container.innerHTML = '';
            
            colourHistory.forEach(colour => {
                const swatch = document.createElement('div');
                swatch.className = 'history-swatch';
                swatch.style.backgroundColor = colour;
                swatch.title = colour;
                swatch.onclick = () => applyHistoryColour(colour);
                
                if (favouriteColours.includes(colour)) {
                    const star = document.createElement('div');
                    star.className = 'favourite-star';
                    star.textContent = '★';
                    swatch.appendChild(star);
                }
                
                container.appendChild(swatch);
            });
        }

        function applyHistoryColour(colour) {
            document.getElementById('customPrimary').value = colour;
            document.getElementById('primaryHex').value = colour;
            updateColourPreview('primary', colour);
            showColourMessage('Applied colour from history!', 'success');
        }

        function applyPreset(preset) {
            document.getElementById('customPrimary').value = preset.primary;
            document.getElementById('primaryHex').value = preset.primary;
            document.getElementById('customSecondary').value = preset.secondary;
            document.getElementById('secondaryHex').value = preset.secondary;
            
            updateColourPreview('primary', preset.primary);
            updateColourPreview('secondary', preset.secondary);
            
            showColourMessage(`Applied ${preset.name} preset!`, 'success');
        }

        function showColourMessage(message, type) {
            const messageEl = document.getElementById('colourMessage');
            messageEl.textContent = message;
            messageEl.className = `colour-message ${type}`;
            messageEl.style.display = 'block';
            
            setTimeout(() => {
                messageEl.style.display = 'none';
            }, 3000);
        }

        function initializeColourSystem() {
            // Initialize presets
            const presetsGrid = document.getElementById('presetsGrid');
            colourPresets.forEach(preset => {
                const presetEl = document.createElement('div');
                presetEl.className = 'preset-item';
                presetEl.onclick = () => applyPreset(preset);
                
                presetEl.innerHTML = `
                    <div class="preset-colours">
                        <div class="preset-swatch" style="background-color: ${preset.primary}"></div>
                        <div class="preset-swatch" style="background-color: ${preset.secondary}"></div>
                    </div>
                    <div class="preset-name">${preset.name}</div>
                `;
                
                presetsGrid.appendChild(presetEl);
            });
            
            // Initialize history
            updateHistoryDisplay();
            
            // Initialize contrast indicators
            updateContrastIndicator('primary', '#3b82f6');
            updateContrastIndicator('secondary', '#8b5cf6');
            
            // Enhanced logo upload handler
            document.getElementById('logoUpload').addEventListener('change', handleLogoUpload);
        }

        function handleLogoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Show loading state
            document.getElementById('logoLoadingState').style.display = 'block';
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    // Show logo preview
                    const logoImage = document.getElementById('logoImage');
                    logoImage.src = e.target.result;
                    document.getElementById('logoPreview').style.display = 'block';
                    
                    // Extract colours
                    extractColoursFromImage(img);
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function extractColoursFromImage(img) {
            // Create canvas for colour extraction
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = img.width;
            canvas.height = img.height;
            ctx.drawImage(img, 0, 0);
            
            // Get image data
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            
            // Extract colours
            const colourMap = new Map();
            for (let i = 0; i < data.length; i += 4) {
                const r = data[i];
                const g = data[i + 1];
                const b = data[i + 2];
                const alpha = data[i + 3];
                
                if (alpha > 128) { // Skip transparent pixels
                    const hex = rgbToHex(r, g, b);
                    colourMap.set(hex, (colourMap.get(hex) || 0) + 1);
                }
            }
            
            // Sort by frequency and get top colours
            const sortedColours = Array.from(colourMap.entries())
                .sort((a, b) => b[1] - a[1])
                .slice(0, 8)
                .map(([colour, count]) => ({ colour, count }));
            
            displayExtractedColours(sortedColours);
            
            // Hide loading state
            document.getElementById('logoLoadingState').style.display = 'none';
        }

        function displayExtractedColours(colours) {
            const palette = document.getElementById('colorPalette');
            const info = document.getElementById('extractionInfo');
            const container = document.getElementById('extractedColors');
            const applyBtn = document.getElementById('applyExtractedBtn');
            
            palette.innerHTML = '';
            
            colours.forEach(({ colour, count }, index) => {
                const swatch = document.createElement('div');
                swatch.className = 'color-swatch extracted-swatch';
                swatch.style.backgroundColor = colour;
                swatch.title = `${colour} (${count} pixels)`;
                swatch.dataset.colour = colour;
                swatch.dataset.selected = 'false';
                
                swatch.onclick = () => {
                    swatch.dataset.selected = swatch.dataset.selected === 'true' ? 'false' : 'true';
                    swatch.style.border = swatch.dataset.selected === 'true' ? '3px solid #3b82f6' : '2px solid #e5e7eb';
                };
                
                // Auto-select first two colours
                if (index < 2) {
                    swatch.dataset.selected = 'true';
                    swatch.style.border = '3px solid #3b82f6';
                }
                
                palette.appendChild(swatch);
            });
            
            info.textContent = `Extracted ${colours.length} dominant colours`;
            info.style.display = 'block';
            container.style.display = 'block';
            applyBtn.style.display = 'block';
        }

        function applyExtractedColors() {
            const selectedSwatches = document.querySelectorAll('.extracted-swatch[data-selected="true"]');
            if (selectedSwatches.length >= 1) {
                const primaryColour = selectedSwatches[0].dataset.colour;
                const secondaryColour = selectedSwatches.length > 1 ? selectedSwatches[1].dataset.colour : primaryColour;
                
                document.getElementById('customPrimary').value = primaryColour;
                document.getElementById('primaryHex').value = primaryColour;
                document.getElementById('customSecondary').value = secondaryColour;
                document.getElementById('secondaryHex').value = secondaryColour;
                
                updateColourPreview('primary', primaryColour);
                updateColourPreview('secondary', secondaryColour);
                
                showColourMessage('Applied extracted colours!', 'success');
            } else {
                showColourMessage('Please select at least one colour.', 'error');
            }
        }

        // Legacy function for compatibility
        function applyCustomColors() {
            const primary = document.getElementById('customPrimary').value;
            const secondary = document.getElementById('customSecondary').value;
            updateColourPreview('primary', primary);
            updateColourPreview('secondary', secondary);
            showColourMessage('Custom colours applied!', 'success');
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeColourSystem();
            initializeKanban();
        });

        // Kanban System Variables
        let kanbanTasks = JSON.parse(localStorage.getItem('kanbanTasks') || '[]');
        let kanbanProjects = JSON.parse(localStorage.getItem('kanbanProjects') || '["Website Redesign", "Mobile App", "Brand Guidelines"]');
        let currentEditTask = null;

        // Kanban Functions
        function initializeKanban() {
            updateProjectFilter();
            renderKanbanBoard();
            updateStats();
            
            // Add some sample tasks if none exist
            if (kanbanTasks.length === 0) {
                kanbanTasks = [
                    {
                        id: generateId(),
                        title: 'Design homepage hero section',
                        description: 'Create compelling hero section with call-to-action',
                        project: 'Website Redesign',
                        priority: 'high',
                        status: 'backlog',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: generateId(),
                        title: 'Choose colour palette',
                        description: 'Research and select brand colours',
                        project: 'Brand Guidelines',
                        priority: 'medium',
                        status: 'design',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: generateId(),
                        title: 'Mobile responsiveness testing',
                        description: 'Test design across different devices',
                        project: 'Mobile App',
                        priority: 'high',
                        status: 'review',
                        createdAt: new Date().toISOString()
                    }
                ];
                saveKanbanData();
                renderKanbanBoard();
                updateStats();
            }
        }

        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function createNewProject() {
            const projectName = prompt('Enter project name:');
            if (projectName && !kanbanProjects.includes(projectName)) {
                kanbanProjects.push(projectName);
                localStorage.setItem('kanbanProjects', JSON.stringify(kanbanProjects));
                updateProjectFilter();
            }
        }

        function createNewTask() {
            showTaskModal();
        }

        function addTaskToColumn(status) {
            showTaskModal(null, status);
        }

        function showTaskModal(task = null, defaultStatus = 'backlog') {
            const isEdit = task !== null;
            currentEditTask = task;
            
            const modal = document.createElement('div');
            modal.className = 'task-modal';
            modal.innerHTML = `
                <div class="task-modal-content">
                    <h3>${isEdit ? 'Edit Task' : 'New Task'}</h3>
                    <form onsubmit="saveTask(event)">
                        <div class="form-field">
                            <label for="taskTitle">Title *</label>
                            <input type="text" id="taskTitle" value="${task ? task.title : ''}" required>
                        </div>
                        <div class="form-field">
                            <label for="taskDescription">Description</label>
                            <textarea id="taskDescription">${task ? task.description : ''}</textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-field">
                                <label for="taskProject">Project</label>
                                <select id="taskProject">
                                    ${kanbanProjects.map(project => 
                                        `<option value="${project}" ${task && task.project === project ? 'selected' : ''}>${project}</option>`
                                    ).join('')}
                                </select>
                            </div>
                            <div class="form-field">
                                <label for="taskPriority">Priority</label>
                                <select id="taskPriority">
                                    <option value="low" ${task && task.priority === 'low' ? 'selected' : ''}>Low</option>
                                    <option value="medium" ${task && task.priority === 'medium' ? 'selected' : ''}>Medium</option>
                                    <option value="high" ${task && task.priority === 'high' ? 'selected' : ''}>High</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-field">
                            <label for="taskStatus">Status</label>
                            <select id="taskStatus">
                                <option value="backlog" ${(task ? task.status : defaultStatus) === 'backlog' ? 'selected' : ''}>Backlog</option>
                                <option value="design" ${(task ? task.status : defaultStatus) === 'design' ? 'selected' : ''}>In Design</option>
                                <option value="review" ${(task ? task.status : defaultStatus) === 'review' ? 'selected' : ''}>Review</option>
                                <option value="done" ${(task ? task.status : defaultStatus) === 'done' ? 'selected' : ''}>Done</option>
                            </select>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn-secondary" onclick="closeTaskModal()">Cancel</button>
                            <button type="submit" class="btn-primary">${isEdit ? 'Update' : 'Create'} Task</button>
                        </div>
                    </form>
                </div>
            `;
            
            modal.onclick = (e) => {
                if (e.target === modal) closeTaskModal();
            };
            
            document.body.appendChild(modal);
        }

        function saveTask(event) {
            event.preventDefault();
            
            const title = document.getElementById('taskTitle').value;
            const description = document.getElementById('taskDescription').value;
            const project = document.getElementById('taskProject').value;
            const priority = document.getElementById('taskPriority').value;
            const status = document.getElementById('taskStatus').value;
            
            if (currentEditTask) {
                // Update existing task
                const taskIndex = kanbanTasks.findIndex(t => t.id === currentEditTask.id);
                if (taskIndex !== -1) {
                    kanbanTasks[taskIndex] = {
                        ...kanbanTasks[taskIndex],
                        title,
                        description,
                        project,
                        priority,
                        status,
                        updatedAt: new Date().toISOString()
                    };
                }
            } else {
                // Create new task
                kanbanTasks.push({
                    id: generateId(),
                    title,
                    description,
                    project,
                    priority,
                    status,
                    createdAt: new Date().toISOString()
                });
            }
            
            saveKanbanData();
            renderKanbanBoard();
            updateStats();
            closeTaskModal();
        }

        function closeTaskModal() {
            const modal = document.querySelector('.task-modal');
            if (modal) {
                modal.remove();
            }
            currentEditTask = null;
        }

        function deleteTask(taskId) {
            if (confirm('Are you sure you want to delete this task?')) {
                kanbanTasks = kanbanTasks.filter(task => task.id !== taskId);
                saveKanbanData();
                renderKanbanBoard();
                updateStats();
            }
        }

        function editTask(taskId) {
            const task = kanbanTasks.find(t => t.id === taskId);
            if (task) {
                showTaskModal(task);
            }
        }

        function renderKanbanBoard() {
            const columns = ['backlog', 'design', 'review', 'done'];
            const filter = document.getElementById('projectFilter')?.value || '';
            
            columns.forEach(status => {
                const container = document.getElementById(`${status}-tasks`);
                const countEl = document.getElementById(`${status}-count`);
                
                if (!container || !countEl) return;
                
                const filteredTasks = kanbanTasks.filter(task => {
                    return task.status === status && (filter === '' || task.project === filter);
                });
                
                countEl.textContent = filteredTasks.length;
                
                container.innerHTML = filteredTasks.map(task => `
                    <div class="kanban-task" draggable="true" data-task-id="${task.id}" 
                         ondragstart="dragStart(event)" ondragend="dragEnd(event)">
                        <div class="task-actions">
                            <button class="task-action-btn edit-btn" onclick="editTask('${task.id}')" title="Edit">✏</button>
                            <button class="task-action-btn delete-btn" onclick="deleteTask('${task.id}')" title="Delete">✕</button>
                        </div>
                        <div class="task-title">${task.title}</div>
                        <div class="task-description">${task.description}</div>
                        <div class="task-meta">
                            <span class="task-project">${task.project}</span>
                            <span class="task-priority ${task.priority}">${task.priority.toUpperCase()}</span>
                        </div>
                    </div>
                `).join('');
            });
        }

        function updateProjectFilter() {
            const select = document.getElementById('projectFilter');
            if (!select) return;
            
            select.innerHTML = '<option value="">All Projects</option>' + 
                kanbanProjects.map(project => `<option value="${project}">${project}</option>`).join('');
        }

        function filterByProject() {
            renderKanbanBoard();
        }

        function updateStats() {
            const total = kanbanTasks.length;
            const completed = kanbanTasks.filter(task => task.status === 'done').length;
            const active = kanbanTasks.filter(task => task.status === 'design' || task.status === 'review').length;
            const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
            
            document.getElementById('totalTasks').textContent = total;
            document.getElementById('completedTasks').textContent = completed;
            document.getElementById('activeTasks').textContent = active;
            document.getElementById('completionRate').textContent = completionRate + '%';
        }

        function saveKanbanData() {
            localStorage.setItem('kanbanTasks', JSON.stringify(kanbanTasks));
        }

        function exportKanbanData() {
            const data = {
                tasks: kanbanTasks,
                projects: kanbanProjects,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `kanban-export-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Drag and Drop Functions
        function allowDrop(event) {
            event.preventDefault();
            event.currentTarget.closest('.kanban-column').classList.add('drag-over');
        }

        function dragStart(event) {
            event.dataTransfer.setData('text/plain', event.target.dataset.taskId);
            event.target.classList.add('dragging');
        }

        function dragEnd(event) {
            event.target.classList.remove('dragging');
            document.querySelectorAll('.kanban-column').forEach(col => {
                col.classList.remove('drag-over');
            });
        }

        function dropTask(event) {
            event.preventDefault();
            const taskId = event.dataTransfer.getData('text/plain');
            const newStatus = event.currentTarget.closest('.kanban-column').dataset.status;
            
            const task = kanbanTasks.find(t => t.id === taskId);
            if (task && task.status !== newStatus) {
                task.status = newStatus;
                task.updatedAt = new Date().toISOString();
                saveKanbanData();
                renderKanbanBoard();
                updateStats();
            }
            
            event.currentTarget.closest('.kanban-column').classList.remove('drag-over');
        }
        
        // PA Media Template Functions - Integrated with PA Media Templates System
        function downloadPATemplate(type) {
            // Show loading state
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Downloading...';
            button.disabled = true;
            
            setTimeout(() => {
                try {
                    let filename = '';
                    let content = '';
                    
                    if (type === 'website') {
                        filename = 'pa-media-website-templates.html';
                        content = generatePAWebsiteTemplate();
                    } else if (type === 'presentation') {
                        filename = 'pa-media-presentation-templates.html';
                        content = generatePAPresentationTemplate();
                    } else if (type === 'digital') {
                        filename = 'pa-media-digital-assets.html';
                        content = generatePADigitalAssets();
                    }
                    
                    // Create and download the file
                    const blob = new Blob([content], { type: 'text/html' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    // Show success message
                    button.textContent = '✅ Downloaded!';
                    button.style.background = '#059669';
                } catch (error) {
                    console.error('Download failed:', error);
                    button.textContent = '❌ Error';
                    button.style.background = '#dc2626';
                } finally {
                    // Restore button after 2 seconds
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.style.background = '#825FFF';
                        button.disabled = false;
                    }, 2000);
                }
            }, 1000);
        }
        
        // PA Media Template Generators
        function generatePAWebsiteTemplate() {
            return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PA Media - Professional Website Template</title>
    <style>
        :root {
            --pa-primary: #825FFF;
            --pa-secondary: #3D3677;
            --pa-accent: #A855F7;
            --pa-text: #1F2937;
            --pa-light: #F8FAFC;
            --pa-white: #FFFFFF;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--pa-text);
        }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 0 2rem; }
        
        header {
            background: linear-gradient(135deg, var(--pa-primary) 0%, var(--pa-secondary) 100%);
            color: var(--pa-white);
            padding: 2rem 0;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 2rem;
            font-weight: bold;
            color: var(--pa-white);
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
        }
        
        nav a {
            color: var(--pa-white);
            text-decoration: none;
            font-weight: 500;
            transition: opacity 0.3s;
        }
        
        nav a:hover { opacity: 0.8; }
        
        .hero {
            background: var(--pa-light);
            padding: 4rem 0;
            text-align: center;
        }
        
        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: var(--pa-primary);
        }
        
        .hero p {
            font-size: 1.25rem;
            margin-bottom: 2rem;
            color: var(--pa-secondary);
        }
        
        .btn {
            background: var(--pa-primary);
            color: var(--pa-white);
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(130, 95, 255, 0.3);
        }
        
        .features {
            padding: 4rem 0;
            background: var(--pa-white);
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }
        
        .feature {
            text-align: center;
            padding: 2rem;
            border-radius: 12px;
            border: 1px solid #E5E7EB;
        }
        
        .feature h3 {
            color: var(--pa-primary);
            margin-bottom: 1rem;
        }
        
        footer {
            background: var(--pa-secondary);
            color: var(--pa-white);
            padding: 2rem 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">PA Media</div>
                <nav>
                    <ul>
                        <li><a href="#home">Home</a></li>
                        <li><a href="#about">About</a></li>
                        <li><a href="#services">Services</a></li>
                        <li><a href="#contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>
    
    <section class="hero">
        <div class="container">
            <h1>Professional Media Solutions</h1>
            <p>Delivering exceptional content and communication services</p>
            <button class="btn">Get Started</button>
        </div>
    </section>
    
    <section class="features">
        <div class="container">
            <h2 style="text-align: center; margin-bottom: 1rem; color: var(--pa-primary);">Our Services</h2>
            <div class="features-grid">
                <div class="feature">
                    <h3>Content Creation</h3>
                    <p>Professional content development and editorial services</p>
                </div>
                <div class="feature">
                    <h3>Media Distribution</h3>
                    <p>Wide-reaching distribution across multiple platforms</p>
                </div>
                <div class="feature">
                    <h3>Digital Solutions</h3>
                    <p>Cutting-edge digital media and technology solutions</p>
                </div>
            </div>
        </div>
    </section>
    
    <footer>
        <div class="container">
            <p>&copy; 2024 PA Media Group. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>`;
        }
        
        function generatePAPresentationTemplate() {
            return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PA Media - Presentation Templates</title>
    <style>
        :root {
            --pa-primary: #825FFF;
            --pa-secondary: #3D3677;
            --pa-white: #FFFFFF;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 2rem;
            background: #F8FAFC;
        }
        
        .slide {
            width: 1920px;
            height: 1080px;
            background: var(--pa-white);
            margin: 2rem auto;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .slide-header {
            background: linear-gradient(135deg, var(--pa-primary) 0%, var(--pa-secondary) 100%);
            color: var(--pa-white);
            padding: 3rem;
            text-align: center;
        }
        
        .slide-title {
            font-size: 4rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }
        
        .slide-subtitle {
            font-size: 2rem;
            opacity: 0.9;
        }
        
        .slide-content {
            flex: 1;
            padding: 4rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            width: 100%;
        }
        
        .slide-footer {
            background: var(--pa-secondary);
            color: var(--pa-white);
            padding: 2rem;
            text-align: center;
        }
        
        h1, h2, h3 { color: var(--pa-primary); }
        
        .logo {
            font-size: 2rem;
            font-weight: bold;
            color: var(--pa-primary);
        }
    </style>
</head>
<body>
    <div class="slide">
        <div class="slide-header">
            <div class="slide-title">PA Media</div>
            <div class="slide-subtitle">Professional Presentation Template</div>
        </div>
        <div class="slide-content">
            <div class="content-grid">
                <div>
                    <h2>Title Slide</h2>
                    <p>Use this template for professional presentations with PA Media branding.</p>
                </div>
                <div>
                    <h3>Features</h3>
                    <ul>
                        <li>Consistent branding</li>
                        <li>Professional layout</li>
                        <li>Ready for customization</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="slide-footer">
            PA Media Group - Professional Communication Solutions
        </div>
    </div>
    
    <div class="slide">
        <div style="padding: 4rem; text-align: center;">
            <div class="logo">PA Media</div>
            <h1 style="margin: 2rem 0;">Content Slide Template</h1>
            <div class="content-grid">
                <div>
                    <h3>Key Points</h3>
                    <ul style="text-align: left; font-size: 1.5rem; line-height: 2;">
                        <li>Professional design</li>
                        <li>Brand consistency</li>
                        <li>Easy customization</li>
                        <li>Multiple layouts</li>
                    </ul>
                </div>
                <div>
                    <h3>Benefits</h3>
                    <p style="font-size: 1.5rem; line-height: 1.8;">This template provides a professional foundation for all PA Media presentations, ensuring brand consistency and visual appeal.</p>
                </div>
            </div>
        </div>
        <div class="slide-footer">
            © 2024 PA Media Group
        </div>
    </div>
</body>
</html>`;
        }
        
        function generatePADigitalAssets() {
            return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PA Media - Digital Assets Collection</title>
    <style>
        :root {
            --pa-primary: #825FFF;
            --pa-secondary: #3D3677;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 2rem;
            background: #F8FAFC;
        }
        
        .asset-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }
        
        .asset {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        
        .teams-bg {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, var(--pa-primary) 0%, var(--pa-secondary) 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }
        
        .social-template {
            width: 100%;
            height: 300px;
            background: var(--pa-primary);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            margin-bottom: 1rem;
        }
        
        h1 { color: var(--pa-primary); text-align: center; }
        h2 { color: var(--pa-primary); }
    </style>
</head>
<body>
    <h1>PA Media Digital Assets Collection</h1>
    
    <div class="asset-grid">
        <div class="asset">
            <h2>Teams Background #1</h2>
            <div class="teams-bg">PA Media</div>
            <p><strong>Dimensions:</strong> 1920x1080 (16:9)</p>
            <p><strong>Format:</strong> Use as virtual background in Microsoft Teams</p>
            <p><strong>Description:</strong> Professional gradient background with PA Media branding</p>
        </div>
        
        <div class="asset">
            <h2>Teams Background #2</h2>
            <div class="teams-bg" style="background: var(--pa-secondary);">Professional</div>
            <p><strong>Dimensions:</strong> 1920x1080 (16:9)</p>
            <p><strong>Format:</strong> Use as virtual background in Microsoft Teams</p>
            <p><strong>Description:</strong> Solid color background with professional styling</p>
        </div>
        
        <div class="asset">
            <h2>Social Media Template</h2>
            <div class="social-template">
                <h3 style="margin: 0;">PA Media</h3>
                <p style="margin: 1rem 0;">Professional Communication</p>
                <div style="font-size: 0.9rem; opacity: 0.9;">#PAMedia #Professional</div>
            </div>
            <p><strong>Dimensions:</strong> 1080x1080 (Square)</p>
            <p><strong>Format:</strong> Perfect for Instagram, LinkedIn, Facebook posts</p>
        </div>
        
        <div class="asset">
            <h2>Email Signature</h2>
            <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; font-size: 0.9rem;">
                <div style="color: var(--pa-primary); font-weight: bold; margin-bottom: 0.5rem;">John Smith</div>
                <div style="color: var(--pa-secondary);">Senior Manager</div>
                <div style="color: var(--pa-primary); font-weight: bold; margin-top: 0.5rem;">PA Media Group</div>
                <div style="font-size: 0.8rem; color: #666; margin-top: 0.5rem;">
                    📧 john.smith@pamedia.com<br>
                    📱 +44 123 456 7890<br>
                    🌐 www.pamedia.com
                </div>
            </div>
            <p><strong>Format:</strong> HTML email signature template</p>
            <p><strong>Description:</strong> Professional email signature with PA Media branding</p>
        </div>
    </div>
    
    <div style="background: white; padding: 2rem; border-radius: 12px; margin-top: 2rem; text-align: center;">
        <h2>Usage Instructions</h2>
        <p>These digital assets are designed for PA Media Group's professional communications. Use them to maintain brand consistency across all digital platforms.</p>
        <ul style="text-align: left; max-width: 600px; margin: 1rem auto;">
            <li><strong>Teams Backgrounds:</strong> Download and add to Microsoft Teams virtual backgrounds</li>
            <li><strong>Social Media:</strong> Customize text and use for professional social media posts</li>
            <li><strong>Email Signatures:</strong> Copy HTML code and paste into email client signature settings</li>
        </ul>
    </div>
</body>
</html>`;
        }
        
        function generatePABrandGuidelines() {
            return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PA Media - Brand Guidelines</title>
    <style>
        :root {
            --pa-primary: #825FFF;
            --pa-secondary: #3D3677;
            --pa-accent: #A855F7;
            --pa-text: #1F2937;
            --pa-light: #F8FAFC;
            --pa-white: #FFFFFF;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--pa-text);
            background: var(--pa-light);
        }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 2rem; }
        
        .header {
            background: linear-gradient(135deg, var(--pa-primary) 0%, var(--pa-secondary) 100%);
            color: var(--pa-white);
            padding: 4rem 2rem;
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .section {
            background: var(--pa-white);
            border-radius: 12px;
            padding: 3rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        
        .color-palette {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }
        
        .color-swatch {
            text-align: center;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .color-display {
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .color-info {
            padding: 1rem;
            background: var(--pa-white);
        }
        
        .typography-demo {
            margin: 2rem 0;
        }
        
        .logo-showcase {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }
        
        .logo-variant {
            text-align: center;
            padding: 2rem;
            border: 1px solid #E5E7EB;
            border-radius: 8px;
        }
        
        h1, h2, h3 { color: var(--pa-primary); margin-bottom: 1rem; }
        h1 { font-size: 3rem; }
        h2 { font-size: 2rem; }
        h3 { font-size: 1.5rem; }
    </style>
</head>
<body>
    <div class="header">
        <h1>PA Media Brand Guidelines</h1>
        <p style="font-size: 1.2rem; opacity: 0.9;">Professional brand identity and usage guidelines</p>
    </div>
    
    <div class="container">
        <div class="section">
            <h2>Brand Colors</h2>
            <p>Our color palette reflects professionalism, innovation, and trust.</p>
            <div class="color-palette">
                <div class="color-swatch">
                    <div class="color-display" style="background: var(--pa-primary);">Primary</div>
                    <div class="color-info">
                        <strong>#825FFF</strong><br>
                        RGB(130, 95, 255)<br>
                        Main brand color
                    </div>
                </div>
                <div class="color-swatch">
                    <div class="color-display" style="background: var(--pa-secondary);">Secondary</div>
                    <div class="color-info">
                        <strong>#3D3677</strong><br>
                        RGB(61, 54, 119)<br>
                        Supporting color
                    </div>
                </div>
                <div class="color-swatch">
                    <div class="color-display" style="background: var(--pa-accent);">Accent</div>
                    <div class="color-info">
                        <strong>#A855F7</strong><br>
                        RGB(168, 85, 247)<br>
                        Highlight color
                    </div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>Typography</h2>
            <div class="typography-demo">
                <h1 style="margin-bottom: 0.5rem;">Heading 1 - 3rem</h1>
                <p style="margin-bottom: 2rem; color: #6B7280;">Used for main page titles and hero headings</p>
                
                <h2 style="margin-bottom: 0.5rem;">Heading 2 - 2rem</h2>
                <p style="margin-bottom: 2rem; color: #6B7280;">Used for section headings and major content divisions</p>
                
                <h3 style="margin-bottom: 0.5rem;">Heading 3 - 1.5rem</h3>
                <p style="margin-bottom: 2rem; color: #6B7280;">Used for subsections and card titles</p>
                
                <p style="font-size: 1rem; margin-bottom: 1rem;"><strong>Body Text Regular - 1rem</strong></p>
                <p style="margin-bottom: 2rem; color: #6B7280;">Standard body text used for content, descriptions, and general information.</p>
            </div>
        </div>
        
        <div class="section">
            <h2>Logo Usage</h2>
            <div class="logo-showcase">
                <div class="logo-variant">
                    <div style="font-size: 2rem; font-weight: bold; color: var(--pa-primary); margin-bottom: 1rem;">PA Media</div>
                    <p><strong>Primary Logo</strong><br>Use on light backgrounds</p>
                </div>
                <div class="logo-variant" style="background: var(--pa-primary); color: white;">
                    <div style="font-size: 2rem; font-weight: bold; margin-bottom: 1rem;">PA Media</div>
                    <p><strong>Reverse Logo</strong><br>Use on dark backgrounds</p>
                </div>
                <div class="logo-variant">
                    <div style="font-size: 1.5rem; font-weight: bold; color: var(--pa-secondary); margin-bottom: 1rem;">PA MEDIA</div>
                    <p><strong>Text Only</strong><br>For small applications</p>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>Usage Guidelines</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                <div>
                    <h3 style="color: #10B981;">✓ Do</h3>
                    <ul style="color: #374151;">
                        <li>Use approved color combinations</li>
                        <li>Maintain consistent typography</li>
                        <li>Ensure proper logo spacing</li>
                        <li>Keep designs clean and professional</li>
                        <li>Use high-resolution assets</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #DC2626;">✗ Don't</h3>
                    <ul style="color: #374151;">
                        <li>Alter logo proportions or colors</li>
                        <li>Use unauthorized fonts</li>
                        <li>Crowd the logo with other elements</li>
                        <li>Use low-quality or pixelated images</li>
                        <li>Apply effects or distortions to the logo</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>Applications</h2>
            <p>These guidelines apply to all PA Media communications including:</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 2rem 0;">
                <div style="background: var(--pa-light); padding: 1rem; border-radius: 8px; text-align: center;">
                    <strong>Websites</strong><br>Digital platforms
                </div>
                <div style="background: var(--pa-light); padding: 1rem; border-radius: 8px; text-align: center;">
                    <strong>Presentations</strong><br>PowerPoint & slides
                </div>
                <div style="background: var(--pa-light); padding: 1rem; border-radius: 8px; text-align: center;">
                    <strong>Print Materials</strong><br>Brochures & flyers
                </div>
                <div style="background: var(--pa-light); padding: 1rem; border-radius: 8px; text-align: center;">
                    <strong>Digital Assets</strong><br>Social media & email
                </div>
            </div>
        </div>
    </div>
    
    <footer style="background: var(--pa-secondary); color: var(--pa-white); padding: 2rem; text-align: center;">
        <p>&copy; 2024 PA Media Group. Brand Guidelines v1.0</p>
    </footer>
</body>
</html>`;
        }

        function downloadBrandGuidelines() {
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Generating Guidelines...';
            button.disabled = true;
            
            setTimeout(() => {
                try {
                    const content = generatePABrandGuidelines();
                    const blob = new Blob([content], { type: 'text/html' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'pa-media-brand-guidelines.html';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    button.textContent = '✅ Downloaded!';
                    button.style.background = '#059669';
                } catch (error) {
                    console.error('Brand guidelines download failed:', error);
                    button.textContent = '❌ Error';
                    button.style.background = '#dc2626';
                } finally {
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.style.background = '#374151';
                        button.disabled = false;
                    }, 2000);
                }
            }, 1500);
        }
        
        function downloadAllPATemplates() {
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Preparing Complete Suite...';
            button.disabled = true;
            
            setTimeout(() => {
                try {
                    // Download all templates as separate files
                    const templates = [
                        { name: 'pa-media-website-templates.html', content: generatePAWebsiteTemplate() },
                        { name: 'pa-media-presentation-templates.html', content: generatePAPresentationTemplate() },
                        { name: 'pa-media-digital-assets.html', content: generatePADigitalAssets() },
                        { name: 'pa-media-brand-guidelines.html', content: generatePABrandGuidelines() }
                    ];
                    
                    templates.forEach((template, index) => {
                        setTimeout(() => {
                            const blob = new Blob([template.content], { type: 'text/html' });
                            const url = URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = template.name;
                            document.body.appendChild(a);
                            a.click();
                            document.body.removeChild(a);
                            URL.revokeObjectURL(url);
                        }, index * 500);
                    });
                    
                    button.textContent = '✅ Complete Suite Downloaded!';
                    button.style.background = '#059669';
                } catch (error) {
                    console.error('Complete suite download failed:', error);
                    button.textContent = '❌ Error';
                    button.style.background = '#dc2626';
                } finally {
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.style.background = '#825FFF';
                        button.disabled = false;
                    }, 3000);
                }
            }, 2000);
        }
        
        function previewPATemplates() {
            alert('PA Media Template Preview:\n\n• Website Templates - Professional homepage and service pages\n• Presentation Templates - PowerPoint-style slide layouts\n• Digital Assets - Teams backgrounds and social media templates\n• Brand Guidelines - Complete brand identity documentation\n\nUse the download buttons to get the complete template files.');
        }
    </script>

    <script>
        // Notification functions for PA Media downloads
        function showDownloadSuccess(type) {
            const typeNames = {
                'website': 'Website Templates',
                'presentation': 'Presentation Templates', 
                'digital': 'Digital Assets',
                'brand-guidelines': 'Brand Guidelines',
                'complete-suite': 'Complete Template Suite'
            };
            
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 2rem;
                right: 2rem;
                background: #10b981;
                colour: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                font-weight: 500;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
            `;
            
            notification.textContent = `✅ ${typeNames[type] || 'Templates'} downloaded successfully!`;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }
        
        function showDownloadError(type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 2rem;
                right: 2rem;
                background: #ef4444;
                colour: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                font-weight: 500;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            `;
            
            notification.textContent = `❌ Download failed. Please try again.`;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        function openWalkthroughModal() {
            document.getElementById('walkthroughModal').style.display = 'flex';
        }

        function closeWalkthroughModal() {
            document.getElementById('walkthroughModal').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('walkthroughModal');
            if (event.target === modal) {
                closeWalkthroughModal();
            }
            
            const previewModal = document.getElementById('paPreviewModal');
            if (event.target === previewModal) {
                closePAPreviewModal();
            }
        }

        function previewPATemplate(type) {
            let content = '';
            let title = '';
            
            if (type === 'website') {
                title = 'PA Media Website Templates Preview';
                content = generatePAWebsiteTemplate();
            } else if (type === 'presentation') {
                title = 'PA Media Presentation Templates Preview';
                content = generatePAPresentationTemplate();
            } else if (type === 'digital') {
                title = 'PA Media Digital Assets Preview';
                content = generatePADigitalAssets();
            } else if (type === 'print') {
                title = 'PA Media Print Templates Preview';
                content = `<div style="padding: 2rem; background: #f8fafc;">
                    <h2 style="color: #825FFF; margin-bottom: 1rem;">Print Template Preview</h2>
                    <p style="color: #6b7280; margin-bottom: 2rem;">Professional print-ready templates with PA Media branding</p>
                    <div style="background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                        <div style="text-align: center; border-bottom: 3px solid #825FFF; padding-bottom: 1rem; margin-bottom: 2rem;">
                            <h1 style="color: #825FFF; font-size: 2rem; margin-bottom: 0.5rem;">PA MEDIA</h1>
                            <p style="color: #3D3677; font-size: 1.1rem;">Professional Communication Solutions</p>
                        </div>
                        <div style="margin-bottom: 2rem;">
                            <h3 style="color: #374151; margin-bottom: 1rem;">Business Card Template</h3>
                            <div style="background: #825FFF; color: white; padding: 1.5rem; border-radius: 8px; display: inline-block;">
                                <h4 style="color: white; margin-bottom: 0.5rem;">PA MEDIA</h4>
                                <p style="font-size: 0.9rem; margin-bottom: 1rem;">Your Name • Your Title</p>
                                <p style="font-size: 0.8rem; line-height: 1.4;">
                                    email@pamedia.com<br>
                                    www.pamedia.com<br>
                                    +44 20 1234 5678
                                </p>
                            </div>
                        </div>
                        <div>
                            <h3 style="color: #374151; margin-bottom: 1rem;">Letterhead Template</h3>
                            <div style="border: 1px solid #e5e7eb; padding: 2rem; background: white;">
                                <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #825FFF; padding-bottom: 1rem; margin-bottom: 2rem;">
                                    <h2 style="color: #825FFF; margin: 0;">PA MEDIA</h2>
                                    <p style="color: #6b7280; margin: 0; font-size: 0.9rem;">Professional Communication Solutions</p>
                                </div>
                                <p style="color: #374151; line-height: 1.6;">
                                    [Your letter content goes here. This letterhead template provides a professional foundation for all PA Media correspondence.]
                                </p>
                            </div>
                        </div>
                    </div>
                </div>`;
            }
            
            document.getElementById('paPreviewTitle').textContent = title;
            document.getElementById('paPreviewContent').innerHTML = content;
            document.getElementById('paPreviewModal').style.display = 'flex';
        }

        function closePAPreviewModal() {
            document.getElementById('paPreviewModal').style.display = 'none';
        }

        function updateClaudePromptPreview() {
            if (!window.designGenerator) return;
            
            try {
                const data = window.designGenerator.getFormData();
                
                const prompt = `Convert this ${data.style} design template to a modern, responsive website:

**Design Specifications:**
- Style: ${data.style.charAt(0).toUpperCase() + data.style.slice(1)}
- Layout: ${data.template.charAt(0).toUpperCase() + data.template.slice(1)}
- Title: "${data.siteTitle}"
- Subtitle: "${data.siteSubtitle}"
- Colour Scheme: ${data.colorScheme}
- Typography: ${data.fontFamily}

**Navigation Links:**
${Array.isArray(data.navLinks) ? data.navLinks.map(link => `- ${link.trim()}`).join('\n') : data.navLinks.split('\n').map(link => `- ${link.trim()}`).join('\n')}

**Main Content:**
${data.mainContent}

**Requirements:**
- Use modern HTML5 semantic elements
- Include responsive CSS with mobile-first approach
- Add smooth hover effects and transitions
- Ensure accessibility (ARIA labels, proper contrast)
- Include meta tags for SEO
- Use CSS Grid and Flexbox for layouts
- Make it production-ready

**Framework Preference:** You can suggest React, Vue, or vanilla HTML/CSS based on the design complexity.

Please create a complete, professional implementation following the ${data.style} design aesthetic.`;

                document.getElementById('claudePromptPreview').textContent = prompt;
            } catch (error) {
                document.getElementById('claudePromptPreview').textContent = 'Preview will appear when form is filled...';
            }
        }

        // Initialize Design Generator
        window.designGenerator = {
            currentTemplate: 'hero',
            currentStyle: 'minimalist',
            
            getFormData: function() {
                return {
                    template: this.currentTemplate,
                    style: this.currentStyle,
                    siteTitle: document.getElementById('siteTitle')?.value || 'Your Brand',
                    fontFamily: document.getElementById('fontFamily')?.value || 'Inter',
                    primaryColor: document.getElementById('primaryHex')?.value || '#3b82f6',
                    secondaryColor: document.getElementById('secondaryHex')?.value || '#64748b',
                    navLinks: ['Home', 'About', 'Services', 'Contact']
                };
            },
            
            getCurrentData: function() {
                return this.getFormData();
            },
            
            updatePreview: function() {
                this.generateTemplate();
            },
            
            switchTab: function(tabName) {
                // Handle tab switching if needed
            },
            
            generateTemplate: function() {
                // Just store the current template selection, don't try to generate anything
                // This keeps the form data updated for the Claude prompt
                const data = this.getFormData();
                
                // Update the prompt preview
                setTimeout(updateClaudePromptPreview, 50);
            },
            
            showMessage: function(message, type) {
                // Simple message display
                const existingMessage = document.querySelector('.template-message');
                if (existingMessage) {
                    existingMessage.remove();
                }
                
                const messageDiv = document.createElement('div');
                messageDiv.className = `template-message ${type}`;
                messageDiv.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 12px 20px;
                    border-radius: 6px;
                    z-index: 10000;
                    font-weight: 500;
                    ${type === 'success' ? 'background: #10b981; color: white;' : 'background: #ef4444; color: white;'}
                `;
                messageDiv.textContent = message;
                document.body.appendChild(messageDiv);
                
                setTimeout(() => messageDiv.remove(), 3000);
            }
        };


        // Update prompt preview when page loads and form changes
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(updateClaudePromptPreview, 1000);
            
            // Update prompt when form inputs change
            const formInputs = document.querySelectorAll('input, select, textarea');
            formInputs.forEach(input => {
                input.addEventListener('input', updateClaudePromptPreview);
                input.addEventListener('change', updateClaudePromptPreview);
            });
            
            // Handle template option clicks - just update the selection
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('template-option') || e.target.closest('.template-option')) {
                    const templateOption = e.target.classList.contains('template-option') ? 
                        e.target : e.target.closest('.template-option');
                    
                    // Remove active class from all options
                    document.querySelectorAll('.template-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    
                    // Add active class to clicked option
                    templateOption.classList.add('active');
                    
                    // Update current template
                    const templateName = templateOption.dataset.template;
                    if (templateName) {
                        window.designGenerator.currentTemplate = templateName;
                        setTimeout(updateClaudePromptPreview, 100);
                    }
                }
            });
        });
    </script>

    <!-- Walkthrough Modal -->
    <div id="walkthroughModal" class="walkthrough-modal" style="display: none;">
        <div class="modal-overlay" onclick="closeWalkthroughModal()"></div>
        <div class="walkthrough-content">
            <div class="walkthrough-header">
                <h2>Homepage Design Generator - Quick Walkthrough</h2>
                <button onclick="closeWalkthroughModal()" class="modal-close">&times;</button>
            </div>
            <div class="walkthrough-body">
                <div class="walkthrough-step">
                    <h3>1. Choose Your Layout Template</h3>
                    <p>Select from professional layout templates including Hero, Centred, Sidebar, Grid, Split, and Masonry. All templates use a clean, simple design aesthetic.</p>
                </div>
                <div class="walkthrough-step">
                    <h3>2. Customise Your Design</h3>
                    <p>Use the advanced customisation controls to adjust density, width, borders, and shadows. Customise colours, typography, and content to match your brand.</p>
                </div>
                <div class="walkthrough-step">
                    <h3>3. Preview & Export</h3>
                    <p>Your design preview updates automatically as you make changes. Use "Quick Export" to download complete HTML files ready for deployment.</p>
                </div>
                <div class="walkthrough-step">
                    <h3>4. Additional Features</h3>
                    <ul>
                        <li><strong>URL Import:</strong> Import existing website designs to modify</li>
                        <li><strong>PA Media Templates:</strong> Access professional media brand templates</li>
                        <li><strong>Claude Code Integration:</strong> Generate prompts for further development</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- PA Media Preview Modal -->
    <div id="paPreviewModal" class="walkthrough-modal" style="display: none;">
        <div class="modal-overlay" onclick="closePAPreviewModal()"></div>
        <div class="walkthrough-content" style="max-width: 900px; max-height: 90vh;">
            <div class="walkthrough-header">
                <h2 id="paPreviewTitle">PA Media Template Preview</h2>
                <button onclick="closePAPreviewModal()" class="modal-close">&times;</button>
            </div>
            <div class="walkthrough-body" style="max-height: 70vh; overflow-y: auto;">
                <div id="paPreviewContent">
                    <!-- Preview content will be inserted here -->
                </div>
            </div>
        </div>
    </div>
</body>
</html>
